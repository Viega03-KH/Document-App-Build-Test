import{k as c,d as u,a as d,o as h,b as n,v as o,q as g,E as i,A as k}from"./index-CDbZ6Fa9.js";/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x=c("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),p={class:"text-[#697696] text-md font-medium"},f={class:"text-dark text-lg font-bold"},M={__name:"UInfoItem",props:{label:String,value:[String,Number]},setup(e){const s=u(!1);return(t,a)=>(h(),d("div",{class:g([t.$attrs.class,"relative cursor-pointer"]),onMouseenter:a[0]||(a[0]=r=>s.value=!0),onMouseleave:a[1]||(a[1]=r=>s.value=!1)},[n("p",p,o(e.label),1),n("p",f,o(e.value),1)],34))}},m=e=>i.post("/task_create",e),y=(e=1,s=null)=>{let t=`/task_list?page=${e}`;return s&&(t+=`&status_id=${s}`),i.get(t)},_=e=>i.get(`/task_view/${e}`),v=(e,s)=>i.put(`/task_update/${e}`,s),S=e=>i.delete(`/task_delete/${e}`),w=k("task",{state:()=>({tasks:[],pagination:{current_page:1,last_page:1,total:0},selectedTask:null,loading:!1,error:null,lastMessage:null,status_id:null}),actions:{async createTask(e={}){this.loading=!0,this.error=null,this.lastMessage=null;try{const s=await m(e);console.log("Backend response:",s.data);const t=s?.data?.message||"Xatolik yuz berdi";if(this.lastMessage=t,s?.data?.success===!0||t.toLowerCase().includes("yaratildi")||t.toLowerCase().includes("yangilandi")){const r=s?.data?.tasks||[];return r.forEach(l=>{l&&this.tasks.push(l)}),this.error=null,r}return this.error=t,!1}catch(s){return this.error=s?.response?.data?.message||s.message||"Server xatosi",this.lastMessage=this.error,!1}finally{this.loading=!1}},async fetchAll(e=1){this.loading=!0,this.error=null;try{const s=await y(e,this.status_id);return this.tasks=s.data.data||[],this.pagination.current_page=s.data.current_page,this.pagination.last_page=s.data.last_page,this.pagination.total=s.data.total,this.tasks}catch(s){this.error=s?.response?.data?.message||s.message||"Server xatosi"}finally{this.loading=!1}},async fetchOne(e){this.loading=!0,this.error=null;try{const s=await _(e);return this.selectedTask=s?.data||null,this.selectedTask}catch(s){this.error=s?.response?.data?.message||s.message||"Server xatosi"}finally{this.loading=!1}},async update(e,s={}){this.loading=!0,this.error=null;try{const t=await v(e,s);if(t?.data?.success){const a=t.data.task,r=this.tasks.findIndex(l=>l.id===e);return r!==-1&&(this.tasks[r]=a),a}else this.error=t?.data?.message||"Noma'lum xatolik"}catch(t){this.error=t?.response?.data?.message||t.message||"Server xatosi"}finally{this.loading=!1}},async delete(e){this.loading=!0,this.error=null,this.lastMessage=null;try{const s=await S(e);if(s?.data?.message)return this.tasks=this.tasks.filter(a=>a.id!==e),this.selectedTask?.id===e&&(this.selectedTask=null),this.lastMessage=s.data.message,{success:!0,message:this.lastMessage};const t=s?.data?.message||"Xatolik yuz berdi";return this.error=t,this.lastMessage=t,{success:!1,message:t}}catch(s){const t=s?.response?.data?.message||s.message||"Server xatosi";return this.error=t,this.lastMessage=t,{success:!1,message:t}}finally{this.loading=!1}},setSelectedTask(e){this.selectedTask=e}}});export{x as S,M as _,w as u};
