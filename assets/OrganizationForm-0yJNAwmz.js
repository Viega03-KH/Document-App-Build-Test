import{E as s,A as k,G as S,u as U,r as p,a as N,o as V,b as e,g as r,v as m,h as g,f as o,j as _,w as B}from"./index-CDbZ6Fa9.js";import{u as L,X as M}from"./useFormValidate-kLZtjoVo.js";const q=()=>s.get("/organizations_list"),A=a=>s.post("/organizations_create",a),C=a=>s.get(`/organizations_view/${a}`),j=(a,t)=>s.post(`/organizations_update/${a}`,t),E=a=>s.delete(`/organizations_delete/${a}`),F=k("organizations",{state:()=>({organizations:[],selectedOrganizations:null,loading:!1,error:null}),actions:{async fetchAll(){this.loading=!0,this.error=null;try{const a=await q();this.organizations=a.data||[]}catch(a){console.error("Organizations olishda xato:",a),this.error=a}finally{this.loading=!1}},async fetchOne(a){this.loading=!0,this.error=null;try{const t=await C(a);this.selectedOrganizations=t.data||null}catch(t){console.error("Organization olishda xato:",t),this.error=t}finally{this.loading=!1}},async create(a){this.loading=!0,this.error=null;try{await A(a),await this.fetchAll()}catch(t){console.error("Organization yaratishda xato:",t),this.error=t}finally{this.loading=!1}},async update(a,t){this.loading=!0,this.error=null;try{await j(a,t),await this.fetchAll()}catch(i){console.error("Organization yangilashda xato:",i),this.error=i}finally{this.loading=!1}},async remove(a){this.loading=!0,this.error=null;try{await E(a),this.organizations=this.organizations.filter(t=>t.id!==a)}catch(t){console.error("Organization oâ€˜chirishda xato:",t),this.error=t}finally{this.loading=!1}}}}),T={class:"flex flex-col w-[700px]"},Y={class:"flex justify-between modal-border items-center p-[14px] border-b"},$={class:"text-dark text-lg font-bold uppercase"},I={class:"flex flex-wrap -mx-2 p-4"},X={class:"w-full px-2 py-2"},D={class:"justify-end border-t modal-card modal-border flex items-center p-4"},J={__name:"OrganizationForm",props:{id:{type:Number,default:null}},setup(a){const t=F(),i=S(),c=U(),{form:n,errors:y,validate:z,resetForm:w}=L({name_oz:"",name_uz:"NULL",name_ru:"NULL",name_en:"NULL"},{name_oz:{required:!0,message:"Majburiy"}}),f=a,d=!!f.id,x=async()=>{if(z())try{d?(await t.update(f.id,n),c.show("Muvaffaqiyatli yangilandi","succsess")):(await t.create(n),c.show("Muvaffaqiyatli yaratildi","succsess")),u(),w()}catch{c.show("Xatolik yuz berdi","")}},u=()=>i.close();return(b,l)=>{const h=p("UButton"),v=p("UInput");return V(),N("div",T,[e("div",Y,[e("p",$,m(d?"Yangilash":"Yangi"),1),r(h,{customClass:"bg-[#475467] rounded-full p-1",onClick:u},{default:g(()=>[r(o(M),{"stroke-width":"3",class:"w-4 h-4 text-white"})]),_:1})]),e("form",{onSubmit:B(x,["prevent"]),class:"space-y-6"},[e("div",I,[e("div",X,[r(v,{modelValue:o(n).name_oz,"onUpdate:modelValue":l[0]||(l[0]=O=>o(n).name_oz=O),label:"Tashkelot",placeholder:"Tashkelot nomini kiriting",error:o(y).name_oz},null,8,["modelValue","error"])])]),e("div",D,[r(h,{type:"button",variant:"ghost",onClick:u,disabled:o(t).loading},{default:g(()=>[...l[1]||(l[1]=[_(" Bekor qilish ",-1)])]),_:1},8,["disabled"]),r(h,{type:"submit",variant:"primary",loading:o(t).loading},{default:g(()=>[_(m(d?"Yangilash":"Saqlash"),1)]),_:1},8,["loading"])])],32)])}}};export{J as _,F as u};
