import{d as te}from"./dayjs.min-BKV6yWyi.js";import{k as M,O as ae,J as N,P as oe,a as v,p as F,o as r,b as e,f as n,v as A,c as S,q as Y,y as se,g as a,F as B,x as P,d as j,G as R,u as le,l as X,r as I,h as x,w as ie,j as U,C as ne,t as re,Q as q,U as de,s as ue}from"./index-CDbZ6Fa9.js";import{_ as p,S as K}from"./MultiColumnUserSelect.vue_vue_type_style_index_0_scoped_1fefd64e_lang-gPo00AIL.js";import{d as E,u as O,a as ce,b as me,_ as fe,c as ve}from"./documentfilecreateStore-Ckzfin5E.js";import{u as he,X as pe,P as ye}from"./useFormValidate-kLZtjoVo.js";import{u as _e}from"./OrganizationForm-0yJNAwmz.js";import{u as ge}from"./doctypeStore-DSXDoVxz.js";import{u as ke}from"./deliveryStore-BP9wpT1q.js";import{u as xe}from"./subjectStore-CCQyzlsA.js";import{u as G}from"./dockstatusStore-BMsRw9jQ.js";import{_ as be}from"./CreateTaskForm-BgCuDG3h.js";import{_ as we}from"./UPagination-bpKT0cD6.js";import{T as je}from"./trash-2-CxDXh9iA.js";import"./usersStore-CKquJ-N2.js";import"./user-DCLnJ75f.js";import"./chevron-right-BRVjSxrT.js";/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=M("check-check",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=M("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=M("combine",[["path",{d:"M10 18H5a3 3 0 0 1-3-3v-1",key:"ru65g8"}],["path",{d:"M14 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"e30een"}],["path",{d:"M20 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"2ahx8o"}],["path",{d:"m7 21 3-3-3-3",key:"127cv2"}],["rect",{x:"14",y:"14",width:"8",height:"8",rx:"2",key:"1b0bso"}],["rect",{x:"2",y:"2",width:"8",height:"8",rx:"2",key:"1x09vl"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=M("notepad-text-dashed",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v2",key:"j91f56"}],["path",{d:"M20 12v2",key:"w8o0tu"}],["path",{d:"M20 18v2a2 2 0 0 1-2 2h-1",key:"1c9ggx"}],["path",{d:"M13 22h-2",key:"191ugt"}],["path",{d:"M7 22H6a2 2 0 0 1-2-2v-2",key:"1rt9px"}],["path",{d:"M4 14v-2",key:"1v0sqh"}],["path",{d:"M4 8V6a2 2 0 0 1 2-2h2",key:"1mwabg"}],["path",{d:"M8 10h6",key:"3oa6kw"}],["path",{d:"M8 14h8",key:"1fgep2"}],["path",{d:"M8 18h5",key:"17enja"}]]),Fe={class:"flex flex-row"},Me={class:"flex-1 min-w-0"},Ce={class:"flex items-center justify-between"},De={class:"flex flex-col py-2"},ze={class:"flex items-center justify-between"},Te={class:"flex-1 min-w-0 py-1 text-sm font-medium text-[#697696] line-clamp-2"},Ve="task card-dark border-b px-3 py-4 cursor-pointer hover:bg-[#4076FF0D]",He={__name:"DockListItem",props:{dock:{type:Object,required:!0},active:{type:Boolean,default:!1}},setup(s){const i=ae(),d=(y,l)=>{i.open(y,{x:l.clientX+10,y:l.clientY+10})},h=s,u=N(()=>te(h.dock.doc_date).format("DD MMM YYYY")),_=[{id:1,name:"Qoralama",icon:$e,color:"text-yellow-500"},{id:2,name:"Ro'yxatga olindi, jarayonda",icon:Se,color:"text-yellow-500"},{id:3,name:"Ijrochilarga biriktirildi",icon:Q,color:"text-blue-500"},{id:4,name:"Bajarildi",icon:qe,color:"text-green-500"},{id:5,name:"O'chirildi",icon:oe,color:"text-red-500"}],f=N(()=>_.find(y=>y.id===h.dock.status_id)||{name:"Noma'lum",icon:Q,color:"text-gray-500"});return(y,l)=>s.dock.status_id!==1&&s.dock.status_id!==5?(r(),v("div",{key:0,onClick:l[6]||(l[6]=m=>y.$emit("select",s.dock)),class:Y([Ve,s.active?"bg-[#4076FF0D]":""])},[e("div",Fe,[e("div",Me,[e("div",Ce,[e("h4",{onMouseenter:l[0]||(l[0]=m=>d("Kiruvchi raqam",m)),onMouseleave:l[1]||(l[1]=m=>n(i).close()),class:"text-sm font-extrabold text-black"},A(s.dock.incoming_number),33),e("h4",{onMouseenter:l[2]||(l[2]=m=>d("Ro`yxarga olingan sana",m)),onMouseleave:l[3]||(l[3]=m=>n(i).close()),class:"text-sm font-medium text-[#697696]"},A(u.value),33)]),e("div",De,[e("div",ze,[l[7]||(l[7]=e("span",{class:"flex-1 min-w-0 truncate text-sm font-bold text-black"}," Kiruvchi hujjat ",-1)),(r(),S(se(f.value.icon),{class:Y(["w-5 h-5",f.value.color]),onMouseenter:l[4]||(l[4]=m=>d(f.value.name,m)),onMouseleave:l[5]||(l[5]=m=>n(i).close())},null,40,["class"]))]),e("span",Te,A(s.dock.short_content),1)])])])],2)):F("",!0)}},Ae={key:0},Ie={class:"grid grid-cols-1 md:grid-cols-2 gap-4 pb-4"},Ue={key:0},Be={class:"grid grid-cols-2 gap-2"},Pe={__name:"DockShowItem",props:{dockfile:{type:Object,default:null}},setup(s){return(i,d)=>s.dockfile?(r(),v("div",Ae,[e("div",Ie,[a(p,{label:"Kelib tushgan raqam",value:s.dockfile.incoming_number},null,8,["value"]),a(p,{label:"Chiqish raqami",value:s.dockfile.outgoing_number},null,8,["value"]),a(p,{label:"Hujjat nomi",value:s.dockfile.document_name,class:"md:col-span-2"},null,8,["value"]),a(p,{label:"Ijrochi",value:s.dockfile.executor},null,8,["value"]),a(p,{label:"Telefon raqam",value:s.dockfile.phone_number},null,8,["value"]),a(p,{label:"Qisqa mazmun",value:s.dockfile.short_content,class:"md:col-span-2"},null,8,["value"]),a(p,{label:"Tashkilot",value:s.dockfile.organization_name_oz},null,8,["value"]),a(p,{label:"Hujjat turi",value:s.dockfile.doc_type_name_oz},null,8,["value"]),a(p,{label:"Yetkazib berish usuli",value:s.dockfile.delivery_methods_name_oz},null,8,["value"]),a(p,{label:"Masala turi",value:s.dockfile.issue_type_name_oz},null,8,["value"]),a(p,{label:"Bajarish muddate",value:s.dockfile.doc_date},null,8,["value"])]),s.dockfile.files?.length?(r(),v("div",Ue,[d[0]||(d[0]=e("h3",{class:"font-semibold mb-2"},"Fayllar:",-1)),e("div",Be,[(r(!0),v(B,null,P(s.dockfile.files,h=>(r(),S(E,{key:h.id,file:h},null,8,["file"]))),128))])])):F("",!0)])):F("",!0)}},Le={class:"w-[100vw] md:w-[90vw] 2xl:w-[70vw] h-[95vh] flex flex-col"},Ne={class:"flex justify-between modal-border items-center p-[14px] border-b"},Ye={key:0,class:"flex flex-col h-full justify-center overflow-y-auto"},Ke={key:1,class:"p-6 h-[calc(80vh-64px)] overflow-y-scroll space-y-6"},Qe={class:"w-full flex flex-col py-[16px]"},Re={key:0,class:"mt-4 flex-1 flex flex-col"},Xe={class:"flex-1 overflow-y-auto space-y-2"},Ee={class:"flex justify-end gap-3 p-4 border-t modal-border"},Oe={__name:"UpdateDockForm",props:{id:{type:Number,required:!0}},setup(s){const i=s,d=j([]),h=j([]),u=j(!0),_=O(),f=ce(),y=me(),l=R(),m=le(),C=_e(),D=ge(),z=ke(),T=xe(),g=G(),{form:t,errors:k,validate:V,resetForm:b}=he({organization_id:"",doc_type_id:"",doc_date:"",delivery_method_id:"",subject_id:"",incoming_number:"",outgoing_number:"",status_id:"",document_name:"",short_content:"",signed_by:"",executor:"",phone_number:"",files:[]},{organization_id:{required:!0,message:"Tashkilotni tanlang"},doc_type_id:{required:!0,message:"Hujjat turini tanlang"},delivery_method_id:{required:!0,message:"Yetkazish usulini tanlang"},subject_id:{required:!0,message:"Mavzu majburiy"},status_id:{required:!0,message:"Holatni tanlang"},incoming_number:{required:!0,message:"Kiruvchi raqam majburiy"},outgoing_number:{required:!0,message:"Chiquvchi raqam majburiy"},document_name:{required:!0,message:"Hujjat nomi majburiy"},short_content:{required:!0,message:"Qisqacha mazmun majburiy"},signed_by:{required:!0,message:"Imzolovchini kiriting"},executor:{required:!0,message:"Ijrochini kiriting"},phone_number:{required:!0,message:"Telefon raqamini kiriting"},doc_date:{required:!0,message:"Sanani tanlang"}}),J=()=>d.value.length===0&&t.files.length===0?(k.files="Asos hujjatni yuklang !",!1):(k.files="",!0),W=o=>{o.id?(h.value.push(o.id),d.value=d.value.filter(c=>c.id!==o.id)):o instanceof File&&(t.files=t.files.filter(c=>c!==o))};X(async()=>{await Promise.all([C.fetchAll(),D.fetchAll(),z.fetchAll(),T.fetchAll(),g.fetchAll()]);const o=await _.fetchDock(i.id);Object.assign(t,{organization_id:o.organization_id,doc_type_id:o.doc_type_id,delivery_method_id:o.delivery_method_id,subject_id:o.subject_id,status_id:o.status_id,incoming_number:o.incoming_number,outgoing_number:o.outgoing_number,document_name:o.document_name,short_content:o.short_content,signed_by:o.signed_by,executor:o.executor,phone_number:o.phone_number,doc_date:o.doc_date,files:[]}),d.value=o.files||[],u.value=!1});const Z=async o=>{t.files.length&&(f.files=[...t.files],await f.upload(o),f.response?.length&&await y.createFiles(o,f.response))},L=async()=>{const o=V(),c=J();if(!o||!c){m.show("Iltimos, formani to‘liq to‘ldiring !","error");return}try{await _.createDock(i.id,t);for(const w of h.value)await y.deleteFile(w);h.value=[],await Z(i.id),await _.fetchAll(),H(),m.show("Hujjat muvaffaqiyatli yangilandi !","success")}catch(w){console.error(w),m.show("Hujjatni yangilashda xatolik !","error")}},H=()=>{b(),f.clear(),l.close()};return(o,c)=>{const w=I("UButton"),ee=I("ULoadingspin");return r(),v("div",Le,[e("div",Ne,[c[1]||(c[1]=e("p",{class:"text-black text-md font-bold uppercase"},"Hujjat yaratish",-1)),a(w,{customClass:"bg-[#475467] rounded-full p-1",onClick:H},{default:x(()=>[a(n(pe),{"stroke-width":"3",class:"w-3 h-3 text-white"})]),_:1})]),u.value?(r(),v("div",Ye,[a(ee,{size:"md"})])):(r(),v("div",Ke,[e("form",{onSubmit:ie(L,["prevent"]),class:"flex flex-col h-full"},[a(fe,{model:n(t),errors:n(k)},null,8,["model","errors"]),e("div",Qe,[a(ve,{modelValue:n(t).files,"onUpdate:modelValue":c[0]||(c[0]=$=>n(t).files=$),label:"Hujjat yuklash (asosiy faylni birnchi yuklang)",multiple:"",accept:".pdf,.docx,.jpg,.png",error:n(k).files},null,8,["modelValue","error"]),d.value.length?(r(),v("div",Re,[e("div",Xe,[(r(!0),v(B,null,P(d.value,$=>(r(),S(E,{key:$.id,file:$,"show-delete":!0,onRemove:W},null,8,["file"]))),128))])])):F("",!0)])],32),c[2]||(c[2]=e("div",{class:"h-20"},null,-1))])),e("div",Ee,[a(w,{variant:"ghost",onClick:H},{default:x(()=>[...c[3]||(c[3]=[U("Bekor qilish",-1)])]),_:1}),a(w,{variant:"primary",onClick:L,loading:n(_).loading},{default:x(()=>[...c[4]||(c[4]=[U(" Saqlash va yuborish ",-1)])]),_:1},8,["loading"])])])}}},Ge={class:"mx-auto"},Je={class:"grid grid-cols-1 lg:grid-cols-12"},We={class:"col-span-12 md:col-span-5 2xl:col-span-3"},Ze={class:"card-dark border-b-2 border-x shadow-sm"},et={class:"flex px-1 py-3 items-center border-b card-border justify-between"},tt={class:"flex items-center"},at={class:"flex gap-1"},ot={class:"h-[calc(100vh-8rem)] overflow-y-auto"},st={class:"col-span-12 md:col-span-7 2xl:col-span-9 space-y-2 px-10 h-[calc(100vh-4rem)] overflow-y-auto"},lt={class:"card-dark rounded-b border-b border-x"},it={key:0},nt={class:"flex px-1 py-2 items-center border-b card-border justify-between"},rt={class:"flex items-center gap-2"},dt={key:1,class:"flex flex-col"},ut={class:"grid grid-cols-3 p-6 gap-4"},ct={class:"flex bg-[#F4F6FC] items-center gap-4 justify-end p-6"},Ft={__name:"TransmittedViews",setup(s){const i=O(),d=G(),h=R(),u=j(null),_=j(null),f=j(null),y=g=>i.fetchAll(g);function l(){u.value=null}function m(){i.status_id=f.value,i.fetchAll()}function C(){f.value=null,i.status_id=null,i.fetchAll()}function D(){u.value&&h.open(be,{id:u.value.id})}function z(){u.value&&h.open(Oe,{id:u.value.id})}function T(g){_.value=g.id,u.value=g}return ne(()=>i.docks,g=>{if(u.value){const t=g.find(k=>k.id===u.value.id);t&&(u.value=t)}},{deep:!0}),X(async()=>{await d.fetchAll(),await i.fetchAll()}),(g,t)=>{const k=I("UInput"),V=ue("wave");return r(),v("div",Ge,[e("div",Je,[e("div",We,[e("div",Ze,[e("div",et,[e("div",tt,[re((r(),S(q,{onClick:l,variant:"hover"},{default:x(()=>[a(n(K),{"stroke-width":"2",class:"w-6 h-6"})]),_:1})),[[V]]),t[1]||(t[1]=e("h2",{class:"text-[14px] p-2 font-bold uppercase text-[#282F3D]"},"Hujjatlar ro‘yxati",-1))]),e("div",at,[a(we,{total:n(i).pagination.total,currentPage:n(i).pagination.current_page,lastPage:n(i).pagination.last_page,onChange:y},null,8,["total","currentPage","lastPage"])])]),e("div",ot,[(r(!0),v(B,null,P(n(i).docks,b=>(r(),S(He,{key:b.id,dock:b,active:_.value===b.id,onSelect:T},null,8,["dock","active"]))),128)),t[2]||(t[2]=e("div",{class:"h-24 w-full"},null,-1))])])]),e("div",st,[e("div",lt,[u.value?(r(),v("div",it,[e("div",nt,[t[5]||(t[5]=e("h2",{class:"text-[14px] p-2 font-bold uppercase text-[#282F3D]"},"Kiruvchi hujjat",-1)),e("div",rt,[a(q,{onClick:D,variant:"primary"},{default:x(()=>[a(n(ye),{"stroke-width":"3",class:"text-white"}),t[3]||(t[3]=e("span",{class:"px-1"},"Topshiriq yaratish",-1))]),_:1}),a(q,{onClick:z,variant:"primary"},{default:x(()=>[...t[4]||(t[4]=[U("Tahrirlash",-1)])]),_:1})])]),a(Pe,{class:"p-[24px]",dockfile:u.value},null,8,["dockfile"])])):(r(),v("div",dt,[e("div",null,[t[6]||(t[6]=e("div",{class:"flex p-3 items-center card-border border-b justify-between"},[e("h2",{class:"text-[14px] py-2 font-bold uppercase text-[#282F3D]"},"Qidirish")],-1)),e("div",ut,[a(de,{modelValue:f.value,"onUpdate:modelValue":t[0]||(t[0]=b=>f.value=b),options:n(d).status,"option-label":"name_oz","option-value":"id",placeholder:"Hujjat holati"},null,8,["modelValue","options"]),a(k,{placeholder:"Hujjat raqami (qidiruv mavjud emas)",readonly:""}),a(k,{placeholder:"Kalit so'z (qidiruv mavjud emas)",readonly:""})])]),e("div",ct,[a(q,{class:"flex items-center",onClick:C},{default:x(()=>[a(n(je),{"stroke-width":"2.5",class:"w-5 h-5"}),t[7]||(t[7]=e("span",{class:"px-2"},"Tozalash",-1))]),_:1}),a(q,{variant:"primary",class:"flex items-center",onClick:m},{default:x(()=>[a(n(K),{"stroke-width":"2.5",class:"w-5 h-5"}),t[8]||(t[8]=e("span",{class:"px-2"},"Qidirish",-1))]),_:1})])]))])])])])}}};export{Ft as default};
