import{u as z}from"./usersStore-X1Eo3v4A.js";import{u as j}from"./departmentStore-_V2Om0zp.js";import{u as M,G as B,r as V,a as $,o as F,b as e,g as o,h as _,f as t,j as S,E,A,d as N,l as I,v as y,w as T,O as Y,J as O,F as L,x as R,H as X}from"./index-CSjzk14l.js";import{_ as G}from"./UPagination-Bh_ERdJu.js";import{X as P,u as H,P as J}from"./useFormValidate-BcjMOXJJ.js";import{u as K}from"./user-BRUuMk4P.js";import{d as Q}from"./dayjs.min-BqfIiCKI.js";import{S as W}from"./square-pen-BgiZXzrr.js";import{T as Z}from"./trash-2-wLns3X12.js";import"./chevron-right-fchhoz2G.js";const ee={class:"max-w-xl max-h-xl"},te={class:"flex justify-between modal-border items-center p-[14px] border-b"},se={class:"justify-end border-t modal-card flex gap-2 p-4"},oe={__name:"UserDelete",props:{userId:{type:Number,required:!0}},setup(f){const u=f,m=z(),x=M(),a=B(),g=async()=>{try{await m.removeUser(u.userId),x.show("Foydalanuvchi muvaffaqiyatli o‘chirildi!","success"),a.close()}catch(v){x.show("Xatolik yuz berdi!","error"),console.error(v)}};return(v,n)=>{const b=V("UButton");return F(),$("div",ee,[e("div",te,[n[2]||(n[2]=e("p",{class:"text-dark text-lg font-semibold"},"Foydalanuvchini o‘chirish",-1)),o(b,{customClass:"bg-[#475467] rounded-full p-1",onClick:n[0]||(n[0]=s=>t(a).close())},{default:_(()=>[o(t(P),{"stroke-width":"3",class:"w-4 h-4 text-white"})]),_:1})]),n[5]||(n[5]=e("div",{class:"p-4 text-center space-y-4"},[e("p",{class:"text-base text-dark"}," Siz rostdan ham bu foydalanuvchini o‘chirmoqchimisiz? ")],-1)),e("div",se,[o(b,{variant:"ghost",onClick:n[1]||(n[1]=s=>t(a).close()),disabled:t(m).loading},{default:_(()=>[...n[3]||(n[3]=[S(" Bekor qilish ",-1)])]),_:1},8,["disabled"]),o(b,{variant:"danger",onClick:g,loading:t(m).loading},{default:_(()=>[...n[4]||(n[4]=[S(" O‘chirish ",-1)])]),_:1},8,["loading"])])])}}},le=()=>E.get("/roles_list"),ae=A("rolls",{state:()=>({rolls:[],selectedRoll:null,loading:!1,error:null}),actions:{async fetchAll(){try{this.loading=!0;const f=await le();this.rolls=f.data}catch(f){this.error=f,console.error("Rolllarni olishda xato:",f)}finally{this.loading=!1}}}}),re={class:"flex flex-col max-w-2xl"},ie={class:"flex justify-between modal-border items-center p-[14px] border-b"},ne={class:"text-black text-md font-bold uppercase"},de={class:"flex flex-wrap -mx-2 p-4"},me={class:"w-full px-2 py-2 xl:w-1/2"},ce={class:"w-full px-2 py-2 xl:w-1/2"},pe={class:"w-full px-2 py-2 xl:w-1/2"},ue={class:"w-full px-2 py-2 xl:w-1/2"},fe={class:"w-full px-2 py-2 xl:w-1/2"},xe={class:"w-full px-2 py-2 xl:w-1/2"},he={class:"w-full px-2 py-2 xl:w-1/2"},ye={class:"w-full px-2 py-2 xl:w-1/2"},ge={class:"justify-end border-t modal-card modal-border flex items-center p-4"},D={__name:"UserForm",props:{userId:{type:Number,default:null}},setup(f){const u=f,m=z(),x=ae(),a=j(),g=M(),v=B(),n={id:null,name:"",email:"",lastname:"",firstname:"",middlename:"",department_id:null,role:"",password:""},b={name:{required:!0,message:"Ism majburiy"},email:{required:!0,message:"Email majburiy"},lastname:{required:!0,message:"Familiya majburiy"},firstname:{required:!0,message:"Sharif majburiy"},middlename:{required:!0,message:"Otasining ismi majburiy"},department_id:{required:!0,message:"Bo‘lim majburiy"},role:{required:!0,message:"Lavozim majburiy"},password:{required:!0,message:"Parol majburiy"}},{form:s,errors:h,validate:c,resetForm:r}=H(n,b),w=N(!1);I(async()=>{if(x.rolls.length||await x.fetchAll(),a.departments.length||await a.fetchAll(),u.userId){w.value=!0,await m.fetchUser(u.userId);const l=m.selectedUser;console.log(l),l&&(s.id=l.id,s.name=l.name,s.lastname=l.lastname,s.firstname=l.firstname,s.middlename=l.middlename,s.email=l.email,s.department_id=l.department_id,s.role=l.role)}});const d=()=>{r(),v.close()},k=async()=>{if(c())try{const l={...s};l.password||delete l.password,w.value?await m.editUser(s.id,l):await m.addUser(l),d(),g.show("Barchasi muvaffaqiyatli!","success")}catch(l){g.show(l?.response?.data?.message||"Xatolik yuz berdi","error"),console.error(l)}};return(l,i)=>{const q=V("UButton"),U=V("UInput"),C=V("USelect");return F(),$("div",re,[e("div",ie,[e("p",ne,y(w.value?"Foydalanuvchini tahrirlash":"Foydalanuvchi qo‘shish"),1),o(q,{customClass:"bg-[#475467] rounded-full p-1",onClick:d},{default:_(()=>[o(t(P),{"stroke-width":"3",class:"w-4 h-4 text-white"})]),_:1})]),e("form",{onSubmit:T(k,["prevent"]),class:"space-y-6"},[e("div",de,[e("div",me,[o(U,{modelValue:t(s).name,"onUpdate:modelValue":i[0]||(i[0]=p=>t(s).name=p),label:"Ism",placeholder:"Ismingizni kiriting",error:t(h).name},null,8,["modelValue","error"])]),e("div",ce,[o(U,{modelValue:t(s).email,"onUpdate:modelValue":i[1]||(i[1]=p=>t(s).email=p),label:"Email",placeholder:"Email manzilingizni kiriting",error:t(h).email},null,8,["modelValue","error"])]),e("div",pe,[o(U,{modelValue:t(s).lastname,"onUpdate:modelValue":i[2]||(i[2]=p=>t(s).lastname=p),label:"Familiya",placeholder:"Familiyangizni kiriting",error:t(h).lastname},null,8,["modelValue","error"])]),e("div",ue,[o(U,{modelValue:t(s).firstname,"onUpdate:modelValue":i[3]||(i[3]=p=>t(s).firstname=p),label:"Ismingiz",placeholder:"Ismingizni kiriting",error:t(h).firstname},null,8,["modelValue","error"])]),e("div",fe,[o(U,{modelValue:t(s).middlename,"onUpdate:modelValue":i[4]||(i[4]=p=>t(s).middlename=p),label:"Otasining ismi",placeholder:"Otasining ismini kiriting",error:t(h).middlename},null,8,["modelValue","error"])]),e("div",xe,[o(C,{modelValue:t(s).department_id,"onUpdate:modelValue":i[5]||(i[5]=p=>t(s).department_id=p),label:"Bo‘lim",options:t(a).departments,"option-label":"name_oz","option-value":"id",placeholder:"Otasining ismini kiriting",error:t(h).department_id},null,8,["modelValue","options","error"])]),e("div",he,[o(C,{modelValue:t(s).role,"onUpdate:modelValue":i[6]||(i[6]=p=>t(s).role=p),label:"Lavozim",options:t(x).rolls,"option-label":"name","option-value":"name",placeholder:"Lavozimni tanlang",error:t(h).role},null,8,["modelValue","options","error"])]),e("div",ye,[o(U,{modelValue:t(s).password,"onUpdate:modelValue":i[7]||(i[7]=p=>t(s).password=p),type:"password",label:"Parol",placeholder:"Parolni yangilamoqchi bo‘lsangiz kiriting",error:t(h).password},null,8,["modelValue","error"])])]),e("div",ge,[o(q,{variant:"ghost",type:"button",onClick:d,disabled:t(m).loading},{default:_(()=>[...i[8]||(i[8]=[S(" Bekor qilish ",-1)])]),_:1},8,["disabled"]),o(q,{type:"submit",variant:"primary",loading:t(m).loading},{default:_(()=>[S(y(w.value?"Yangilash":"Saqlash"),1)]),_:1},8,["loading"])])],32)])}}},_e={class:"flex flex-col gap-4 bg-[#F4F6FC] shadow-md h-screen"},ve={class:"overflow-hidden rounded-lg card-dark"},be={class:"min-w-full divide-y divide-gray-100 dark:divide-gray-600"},we={class:"divide-y divide-gray-100 dark:divide-gray-600"},ke={class:"px-4 border-r py-3 sm:px-6"},Ue={class:"font-medium text-dark"},Ve={class:"px-4 border-r py-3 sm:px-6 flex items-center gap-3"},$e={class:"flex items-center justify-center w-10 h-10 rounded-full bg-gray-200"},Fe=["src"],Se={class:"flex flex-col truncate"},Be={class:"font-medium text-dark truncate"},qe={class:"text-gray-500 dark:text-gray-400 text-sm truncate"},ze={class:"text-gray-500 dark:text-gray-400 text-sm truncate"},Ce={class:"px-4 border-r py-3 sm:px-6"},je={class:"inline-block rounded-md bg-blue-500 px-2 text-white text-sm"},Me={class:"px-4 border-r py-3 sm:px-6"},Ie={class:"px-4 border-r py-3 sm:px-6"},Pe={class:"py-3 px-2 flex justify-center"},De={__name:"UserList",setup(f){const u=z(),m=j(),x=B(),a=Y(),g=(c,r)=>{a.open(c,{x:r.clientX+10,y:r.clientY+10})},v=c=>u.fetchUsers(c),n=O(()=>{const c=new Map;return m.departments.forEach(r=>c.set(r.id,r.name_oz)),c}),b=c=>n.value.get(c)||"—";I(()=>{Promise.all([u.fetchUsers(),m.fetchAll()])});const s=c=>x.open(oe,{userId:c}),h=(c=null)=>x.open(D,{userId:c});return(c,r)=>{const w=V("UButton");return F(),$("div",_e,[e("div",ve,[e("table",be,[r[4]||(r[4]=e("thead",{class:"bg-gray-50 dark:bg-gray-800"},[e("tr",null,[e("th",{class:"px-4 border-r py-3 sm:px-6 text-left text-sm uppercase font-bold text-gray-700 dark:text-gray-200"},"ID"),e("th",{class:"px-4 border-r py-3 sm:px-6 text-left text-sm uppercase font-bold text-gray-700 dark:text-gray-200"},"Foydalanuvchi"),e("th",{class:"px-4 border-r py-3 sm:px-6 text-left text-sm uppercase font-bold text-gray-700 dark:text-gray-200"},"Role"),e("th",{class:"px-4 border-r py-3 sm:px-6 text-left text-sm uppercase font-bold text-gray-700 dark:text-gray-200"},"Bo‘lim"),e("th",{class:"px-4 border-r py-3 sm:px-6 text-left text-sm uppercase font-bold text-gray-700 dark:text-gray-200"},"Yaratilgan sana"),e("th",{class:"py-3 border-r px-2 sm:px-6 text-left text-sm uppercase font-bold text-gray-700 dark:text-gray-200"},"Tahrirlash")])],-1)),e("tbody",we,[(F(!0),$(L,null,R(t(u).users,d=>(F(),$("tr",{class:"hover:bg-[#F4F6FC]",key:d.id},[e("td",ke,[e("span",Ue,"ID-"+y(d.id),1)]),e("td",Ve,[e("div",$e,[e("img",{src:d.avatar||t(K),class:"rounded-full w-10 h-10"},null,8,Fe)]),e("div",Se,[e("span",Be,y(d.name),1),e("span",qe,y(d.lastname)+" "+y(d.firstname),1),e("span",ze,y(d.email),1)])]),e("td",Ce,[e("span",je,y(d.role),1)]),e("td",Me,y(b(d.department_id)),1),e("td",Ie,y(t(Q)(d.created_at).format("DD MMMM YYYY")),1),e("td",Pe,[o(w,{variant:"hover",onMouseenter:r[0]||(r[0]=k=>g("Foydalanuvchini tahrirlash",k)),onMouseleave:r[1]||(r[1]=k=>t(a).close()),onClick:()=>h(d.id)},{default:_(()=>[o(t(W),{class:"w-5 h-5"})]),_:1},8,["onClick"]),o(w,{variant:"hover",onMouseenter:r[2]||(r[2]=k=>g("Foydalanuvchini o‘chirish",k)),onMouseleave:r[3]||(r[3]=k=>t(a).close()),onClick:()=>s(d.id)},{default:_(()=>[o(t(Z),{class:"w-5 h-5 text-red-500"})]),_:1},8,["onClick"])])]))),128))])])]),o(G,{total:t(u).pagination.total,currentPage:t(u).pagination.current_page,lastPage:t(u).pagination.last_page,onChange:v},null,8,["total","currentPage","lastPage"])])}}},Ee={class:"overflow-y-scroll h-screen"},Ae={class:"flex flex-col items-center"},Ne={class:"relative flex bg-[#0F172A] shadow-sm flex-col gap-5 sm:flex-row sm:items-center sm:justify-between p-6 w-full overflow-hidden"},Te={class:"flex py-4"},We={__name:"UserViews",setup(f){const u=B();function m(){u.open(D)}return(x,a)=>{const g=V("UButton");return F(),$("div",Ee,[e("div",Ae,[e("div",Ne,[a[2]||(a[2]=X('<svg class="absolute top-0 right-7 w-[400px] h-[200px] opacity-10" viewBox="0 0 200 100" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="20" cy="80" r="20" stroke="#fff" stroke-width="30" fill="none"></circle><circle cx="20" cy="80" r="10" fill="#54774B" opacity="0.5"></circle><circle cx="100" cy="50" r="50" stroke="#fff" stroke-width="20" fill="none"></circle><circle cx="100" cy="50" r="12" fill="#54774B" opacity="0.3"></circle><path d="M 0 100 C 50 80, 150 80, 200 100" stroke="#fff" stroke-width="20" fill="none"></path></svg><h3 class="text-xl font-bold text-white z-10"> Tizim foydalanuvchilari </h3>',2)),o(g,{class:"z-10",variant:"primary",onClick:a[0]||(a[0]=v=>m())},{default:_(()=>[o(t(J),{"stroke-width":"3"}),a[1]||(a[1]=e("span",{class:"px-1"},"Foydalanuvchi qo‘shish",-1))]),_:1})]),e("div",Te,[o(De)])])])}}};export{We as default};
