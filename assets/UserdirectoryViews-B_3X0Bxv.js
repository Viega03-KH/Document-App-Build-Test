import{_ as I,U as T}from"./UModal-C-1hrRal.js";import{u as N}from"./user-BHq0Hx6z.js";import{a as A,d as w,o as U,e,F,z as E,t as y,R as b,B,m as j,r as x,h as s,f as c,i as p,b as f,l as M,w as L,M as H}from"./index-C6LHomsq.js";import"./chevron-right-CQBZ4Jvu.js";/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=A("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=A("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),O={class:"card-dark text-dark bg-zinc-100 border-b-2"},G={__name:"TheadDock",setup(t){const a=[{key:"id",label:"Foydalanuvchi ID raqami"},{key:"name",label:"To‘liq ism va elektron pochta"},{key:"departments_id",label:"Foydalanuvchi roli"},{key:"role_names",label:"Bo‘lim yoki lavozim nomi"},{key:"created_at",label:"Yaratilgan sana va vaqt"},{key:"actions",label:"Amallar (tahrirlash / o‘chirish)"}];return(o,h)=>(U(),w("thead",O,[e("tr",null,[(U(),w(F,null,E(a,m=>e("th",{key:m.key,class:"px-4 text-start py-3.5 sm:px-6"},y(m.label),1)),64))])]))}},J=(t=1)=>b.get(`/user_list?page=${t}`),K=t=>b.post("/user_create",t),Q=t=>b.get(`/user_show/${t}`),W=(t,a)=>b.put(`/user_update/${t}`,a),Z=t=>b.delete(`/user_destroy/${t}`),D=B("users",{state:()=>({users:[],pagination:{current_page:1,last_page:1,total:0},selectedUser:null,loading:!1,error:null}),actions:{async fetchUsers(t=null){this.loading=!0,this.error=null;try{const a=t||this.pagination.current_page,o=await J(a);console.log(o.data),this.users=o.data.data||o.data,this.pagination.current_page=o.data.current_page,this.pagination.last_page=o.data.last_page,this.pagination.total=o.data.total}catch(a){this.error=a.message||"Foydalanuvchilarni olishda xatolik yuz berdi"}finally{this.loading=!1}},async fetchUser(t){this.loading=!0;try{const a=await Q(t);this.selectedUser=a.data}catch(a){this.error=a.message}finally{this.loading=!1}},async addUser(t){this.loading=!0;try{return await K(t),await this.fetchUsers(),{success:!0}}catch(a){return this.error=a.message,{success:!1,error:a.message}}finally{this.loading=!1}},async editUser(t,a){this.loading=!0,this.error=null;try{const o=await W(t,a);return await this.fetchUsers(),{success:!0,data:o.data}}catch(o){return this.error=o.response?.data?.message||o.message,console.error("Foydalanuvchini tahrirlashda xatolik:",this.error),{success:!1,error:this.error}}finally{this.loading=!1}},async removeUser(t){this.loading=!0;try{await Z(t),await this.fetchUsers()}catch(a){this.error=a.message}finally{this.loading=!1}}}}),ee=()=>b.get("/department_list"),R=B("departments",{state:()=>({departments:[],selectedDepartment:null,loading:!1,error:null}),actions:{async fetchAll(){try{this.loading=!0;const t=await ee();this.departments=t.data}catch(t){this.error=t,console.error("Departmentlarni olishda xato:",t)}finally{this.loading=!1}}}}),te={class:"min-w-full"},ae={class:"divide-y dark:divide-zinc-600 divide-zinc-100"},le={class:"px-4 py-3.5 sm:px-6"},se={class:"flex items-center gap-3"},oe={class:"font-medium text-dark"},re={class:"px-4 py-3.5 sm:px-6"},ne={class:"flex items-center gap-3"},ie={class:"flex items-center justify-center w-10 h-10 rounded-full bg-zinc-200"},de=["src"],ue={class:"block font-medium text-dark"},ce={class:"text-zinc-500 dark:text-zinc-400 text-sm"},me={class:"px-4 py-3.5 sm:px-6 text-dark"},pe={class:"rounded-full bg-blue-500 px-1 text-zinc-100"},he={class:"px-4 py-3.5 sm:px-6 text-dark"},fe={class:"px-4 py-3.5 sm:px-6 text-dark"},ve={class:"px-4 py-3.5 sm:px-6"},_e={class:"flex items-center"},ge={__name:"UserList",emits:["edit-user","delete-user"],setup(t){const a=D(),o=R();j(()=>{a.fetchUsers(),o.fetchAll()});const h=n=>{a.fetchUsers(n)},m=n=>{const i=o.departments.find(v=>v.department_id===n);return i?i.name_oz:"—"};return(n,i)=>{const v=x("UButton"),k=x("UTooltip");return U(),w(F,null,[e("table",te,[s(G),e("tbody",ae,[(U(!0),w(F,null,E(c(a).users,(u,V)=>(U(),w("tr",{key:u.id||V},[e("td",le,[e("div",se,[e("span",oe," UserID-"+y(u.id)+"/01 ",1)])]),e("td",re,[e("div",ne,[e("div",ie,[e("img",{src:c(N),class:"rounded-full h-10 w-10"},null,8,de)]),e("div",null,[e("span",ue,y(u.name),1),e("span",ce,y(u.email),1)])])]),e("td",me,[e("span",pe,y(u.role),1)]),e("td",he,y(m(u.department_id)),1),e("td",fe,y(u.created_at),1),e("td",ve,[e("div",_e,[s(k,{text:"Foydalanuvchini tahrirlash"},{default:p(()=>[s(v,{onClick:l=>n.$emit("edit-user",u),class:"p-2 rounded-full hover:bg-zinc-200 dark:hover:bg-zinc-600"},{default:p(()=>[s(c(X),{class:"w-5 h-5"})]),_:1},8,["onClick"])]),_:2},1024),s(k,{text:"Foydalanuvchini o'chirish"},{default:p(()=>[s(v,{onClick:l=>n.$emit("delete-user",u.id),class:"p-2 rounded-full hover:bg-zinc-200 dark:hover:bg-zinc-600"},{default:p(()=>[s(c(Y),{class:"w-5 h-5"})]),_:1},8,["onClick"])]),_:2},1024)])])]))),128))])]),s(I,{total:c(a).pagination.total,currentPage:c(a).pagination.current_page,lastPage:c(a).pagination.last_page,onChange:h},null,8,["total","currentPage","lastPage"])],64)}}},ye=()=>b.get("/roles_list"),xe=B("rolls",{state:()=>({rolls:[],selectedRoll:null,loading:!1,error:null}),actions:{async fetchAll(){try{this.loading=!0;const t=await ye();this.rolls=t.data}catch(t){this.error=t,console.error("Rolllarni olishda xato:",t)}finally{this.loading=!1}}}}),we={class:"flex flex-wrap -mx-2"},Ue={class:"w-full px-2 py-2 xl:w-1/2"},ke={class:"w-full px-2 py-2 xl:w-1/2"},be={class:"w-full px-2 py-2 xl:w-1/2"},Ve={class:"w-full px-2 py-2 xl:w-1/2"},$e={class:"w-full px-2 py-2 xl:w-1/2"},Me={class:"w-full px-2 py-2 xl:w-1/2"},Fe={class:"w-full px-2 py-2 xl:w-1/2"},ze={class:"w-full px-2 py-2 xl:w-1/2"},qe={__name:"UserForm",setup(t,{expose:a}){const o=D(),h=xe(),m=R(),n=f(!1),i=f(""),v=f("info"),k=f(0),u=f(!1),V={id:null,name:"",email:"",lastname:"",firstname:"",middlename:"",gender:"",department_id:"",role:"",password:""},l=f({...V}),_=(g=null)=>{g?(u.value=!0,l.value={...g}):(u.value=!1,l.value={...V}),n.value=!0,h.fetchAll(),m.fetchAll()},z=()=>{n.value=!1},q=async()=>{console.log(l.value);try{const g=u.value?await o.editUser(l.value.id,l.value):await o.addUser(l.value);v.value=g?.success?"success":"error",i.value=g?.success?"Muvaffaqiyatli !":"Xatolik yuz berdi !"}catch{v.value="error",i.value="Server bilan aloqa xatosi !"}finally{k.value++,z()}};return a({openModal:_}),(g,r)=>{const P=x("UAlert"),S=x("UButton"),$=x("UInput"),C=x("USelect");return U(),w(F,null,[s(P,{message:i.value,type:v.value,trigger:k.value},null,8,["message","type","trigger"]),e("div",null,[s(S,{variant:"primary",onClick:r[0]||(r[0]=d=>_())},{default:p(()=>[...r[10]||(r[10]=[M(" Foydalanuvchi qo‘shish ",-1)])]),_:1}),s(T,{modelValue:n.value,"onUpdate:modelValue":r[9]||(r[9]=d=>n.value=d),width:"max-w-3xl",title:u.value?"Foydalanuvchini tahrirlash":"Foydalanuvchi qo‘shish"},{footer:p(()=>[s(S,{onClick:z,disabled:c(o).loading},{default:p(()=>[...r[11]||(r[11]=[M(" Bekor qilish ",-1)])]),_:1},8,["disabled"]),s(S,{type:"submit",form:"userForm",variant:"primary",loading:c(o).loading},{default:p(()=>[M(y(u.value?"Yangilash":"Saqlash"),1)]),_:1},8,["loading"])]),default:p(()=>[e("form",{id:"userForm",onSubmit:L(q,["prevent"]),class:"space-y-6 p-4"},[e("div",we,[e("div",Ue,[s($,{type:"text",modelValue:l.value.name,"onUpdate:modelValue":r[1]||(r[1]=d=>l.value.name=d),label:"Name",placeholder:"Enter name",required:""},null,8,["modelValue"])]),e("div",ke,[s($,{modelValue:l.value.email,"onUpdate:modelValue":r[2]||(r[2]=d=>l.value.email=d),type:"email",label:"Email",placeholder:"Enter email",required:""},null,8,["modelValue"])]),e("div",be,[s($,{type:"text",modelValue:l.value.lastname,"onUpdate:modelValue":r[3]||(r[3]=d=>l.value.lastname=d),label:"Last name",placeholder:"Enter last name"},null,8,["modelValue"])]),e("div",Ve,[s($,{type:"text",modelValue:l.value.firstname,"onUpdate:modelValue":r[4]||(r[4]=d=>l.value.firstname=d),label:"First name",placeholder:"Enter first name",required:""},null,8,["modelValue"])]),e("div",$e,[s($,{type:"text",modelValue:l.value.middlename,"onUpdate:modelValue":r[5]||(r[5]=d=>l.value.middlename=d),label:"Middle name",placeholder:"Enter middle name",required:""},null,8,["modelValue"])]),e("div",Me,[s(C,{modelValue:l.value.department_id,"onUpdate:modelValue":r[6]||(r[6]=d=>l.value.department_id=d),options:c(m).departments,label:"Bo‘lim",placeholder:"Bo‘lim tanlang","option-label":"name_oz","option-value":"department_id",loading:c(m).loading,error:c(m).error},null,8,["modelValue","options","loading","error"])]),e("div",Fe,[s(C,{modelValue:l.value.role,"onUpdate:modelValue":r[7]||(r[7]=d=>l.value.role=d),options:c(h).rolls,label:"Bo‘lim",placeholder:"Rollni tanlang","option-label":"name","option-value":"name",loading:c(h).loading,error:c(h).error},null,8,["modelValue","options","loading","error"])]),e("div",ze,[s($,{modelValue:l.value.password,"onUpdate:modelValue":r[8]||(r[8]=d=>l.value.password=d),label:"Password",placeholder:"Enter password",required:""},null,8,["modelValue"])])])],32)]),_:1},8,["modelValue","title"])])],64)}}},Se={__name:"UserDelete",setup(t,{expose:a}){const o=f(""),h=f("info"),m=f(0),n=D(),i=f(!1),v=f(null),k=l=>{v.value=l,i.value=!0},u=()=>{i.value=!1},V=async()=>{try{await n.removeUser(v.value),i.value=!1,h.value="success",o.value="Muvaffaqiyatli!"}catch(l){console.error("Foydalanuvchini o‘chirishda xato:",l),h.value="error",o.value="Xatolik!"}m.value++};return a({openModal:k}),(l,_)=>{const z=x("UAlert"),q=x("UButton");return U(),w(F,null,[s(z,{message:o.value,type:h.value,trigger:m.value},null,8,["message","type","trigger"]),s(T,{modelValue:i.value,"onUpdate:modelValue":_[0]||(_[0]=g=>i.value=g),width:"max-w-md",title:"Foydalanuvchini o‘chirish"},{footer:p(()=>[s(q,{onClick:u,disabled:c(n).loading},{default:p(()=>[..._[1]||(_[1]=[M(" Bekor qilish ",-1)])]),_:1},8,["disabled"]),s(q,{variant:"danger",onClick:V,loading:c(n).loading},{default:p(()=>[..._[2]||(_[2]=[M(" O‘chirish ",-1)])]),_:1},8,["loading"])]),default:p(()=>[_[3]||(_[3]=e("div",{class:"space-y-4 text-center p-4"},[e("p",{class:"text-dark text-base"}," Siz rostdan ham bu foydalanuvchini o‘chirmoqchimisiz? ")],-1))]),_:1},8,["modelValue"])],64)}}},Be={class:"min-h-[80vh] flex flex-col space-y-6"},De={class:"flex flex-col gap-5 sm:flex-row sm:items-center sm:justify-between"},Ce={class:"flex flex-col gap-3 sm:flex-row sm:items-center"},Te={class:"flex-1 overflow-hidden shadow rounded card-dark border-2"},Ae={class:"max-w-full overflow-x-auto custom-scrollbar"},Ne={__name:"UserdirectoryViews",setup(t){const a=f(),o=f();function h(n=null){a.value.openModal(n)}function m(n){o.value.openModal(n)}return(n,i)=>(U(),w("div",Be,[e("div",De,[i[1]||(i[1]=e("h3",{class:"text-xl font-bold text-dark"}," Tizim foydalanuvchilari ",-1)),e("div",Ce,[s(H,{variant:"primary"},{default:p(()=>[...i[0]||(i[0]=[M("Filter",-1)])]),_:1}),s(qe,{ref_key:"userFormRef",ref:a},null,512),s(Se,{ref_key:"userDeleteRef",ref:o},null,512)])]),e("div",Te,[e("div",Ae,[s(ge,{onEditUser:h,onDeleteUser:m})])])]))}};export{Ne as default};
