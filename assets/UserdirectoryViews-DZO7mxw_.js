import{i as B,r as b,b as h,o as v,d as t,h as U,t as _,f as s,w as u,e as d,F as M,v as E,H as $,z as P,j as L,_ as H,m as S,T as j,p as X,l as A,a as g,J,K as O}from"./index-BLvlj6I_.js";import{C as Y}from"./chevron-right-Cr6Eld-A.js";/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=B("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=B("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=B("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=B("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Z={class:"flex items-center w-full px-6 py-4 justify-between border-t-2 dark:border-zinc-600 dark:shadow-black"},ee={class:"text-dark text-lg"},te={class:"text-blue-500 font-extrabold"},ae={class:"flex items-center"},le={class:"px-4 py-2 text-sm font-medium text-gray-700"},se={__name:"UPagination",props:{currentPage:{type:Number,required:!0},lastPage:{type:Number,required:!0},total:{type:Number,required:!0}},setup(e){return(l,a)=>{const c=b("UButton");return v(),h("div",Z,[t("div",ee,[a[2]||(a[2]=U("Jadvalda mavjud barcha ma’lumotlar ustunlari ro‘yxati ",-1)),t("span",te,_(e.total),1),a[3]||(a[3]=U(" ta ",-1))]),t("div",ae,[s(c,{variant:"primary",disabled:e.currentPage===1,onClick:a[0]||(a[0]=n=>l.$emit("change",e.currentPage-1))},{default:u(()=>[s(d(K),{class:"w-4 h-4"}),a[4]||(a[4]=t("span",{class:"hidden sm:inline"},"Previous",-1))]),_:1},8,["disabled"]),t("span",le,_(e.currentPage)+" / "+_(e.lastPage),1),s(c,{variant:"primary",disabled:e.currentPage===e.lastPage,onClick:a[1]||(a[1]=n=>l.$emit("change",e.currentPage+1))},{default:u(()=>[a[5]||(a[5]=t("span",{class:"hidden sm:inline"},"Next",-1)),s(d(Y),{class:"w-4 h-4"})]),_:1},8,["disabled"])])])}}},oe={class:"card-dark text-dark bg-zinc-100 border-b-2"},re={__name:"TheadDock",setup(e){const l=[{key:"id",label:"Foydalanuvchi ID raqami"},{key:"name",label:"To‘liq ism va elektron pochta"},{key:"departments_id",label:"Foydalanuvchi roli"},{key:"role_names",label:"Bo‘lim yoki lavozim nomi"},{key:"created_at",label:"Yaratilgan sana va vaqt"},{key:"actions",label:"Amallar (tahrirlash / o‘chirish)"}];return(a,c)=>(v(),h("thead",oe,[t("tr",null,[(v(),h(M,null,E(l,n=>t("th",{key:n.key,class:"px-4 text-start py-3.5 sm:px-6"},_(n.label),1)),64))])]))}},ne=(e=1)=>$.get(`/user_list?page=${e}`),ie=e=>$.post("/user_create",e),de=e=>$.get(`/user_show/${e}`),ue=(e,l)=>$.put(`/user_update/${e}`,l),ce=e=>$.delete(`/user_destroy/${e}`),D=P("users",{state:()=>({users:[],pagination:{current_page:1,last_page:1,total:0},selectedUser:null,loading:!1,error:null}),actions:{async fetchUsers(e=null){this.loading=!0,this.error=null;try{const l=e||this.pagination.current_page,a=await ne(l);console.log(a.data),this.users=a.data.data||a.data,this.pagination.current_page=a.data.current_page,this.pagination.last_page=a.data.last_page,this.pagination.total=a.data.total}catch(l){this.error=l.message||"Foydalanuvchilarni olishda xatolik yuz berdi"}finally{this.loading=!1}},async fetchUser(e){this.loading=!0;try{const l=await de(e);this.selectedUser=l.data}catch(l){this.error=l.message}finally{this.loading=!1}},async addUser(e){this.loading=!0;try{return await ie(e),await this.fetchUsers(),{success:!0}}catch(l){return this.error=l.message,{success:!1,error:l.message}}finally{this.loading=!1}},async editUser(e,l){this.loading=!0,this.error=null;try{const a=await ue(e,l);return await this.fetchUsers(),{success:!0,data:a.data}}catch(a){return this.error=a.response?.data?.message||a.message,console.error("Foydalanuvchini tahrirlashda xatolik:",this.error),{success:!1,error:this.error}}finally{this.loading=!1}},async removeUser(e){this.loading=!0;try{await ce(e),await this.fetchUsers()}catch(l){this.error=l.message}finally{this.loading=!1}}}}),me=()=>$.get("/departments"),R=P("departments",{state:()=>({departments:[],selectedDepartment:null,loading:!1,error:null}),actions:{async fetchAll(){try{this.loading=!0;const e=await me();this.departments=e.data}catch(e){this.error=e,console.error("Departmentlarni olishda xato:",e)}finally{this.loading=!1}}}}),pe={class:"min-w-full border-collapse"},fe={class:"divide-y dark:divide-zinc-600 divide-zinc-100"},he={class:"px-4 py-3.5 sm:px-6"},ve={class:"flex items-center gap-3"},_e={class:"font-medium text-dark"},ge={class:"px-4 py-3.5 sm:px-6"},ye={class:"flex items-center gap-3"},xe={class:"flex items-center justify-center w-10 h-10 rounded-full bg-[#fdf2fa]"},be={class:"text-xs font-semibold text-[#dd2590]"},ke={class:"block font-medium text-dark"},we={class:"text-zinc-500 dark:text-zinc-400 text-sm"},Ue={class:"px-4 py-3.5 sm:px-6 text-dark"},$e={class:"rounded-full bg-blue-500 px-1 text-zinc-100"},Ve={class:"px-4 py-3.5 sm:px-6 text-dark"},ze={class:"px-4 py-3.5 sm:px-6 text-dark"},Me={class:"px-4 py-3.5 sm:px-6"},qe={class:"flex items-center"},Fe={__name:"UserList",emits:["edit-user","delete-user"],setup(e){const l=D(),a=R();L(()=>{l.fetchUsers(),a.fetchAll()});const c=n=>{l.fetchUsers(n)};return(n,p)=>{const i=b("UButton"),k=b("UTooltip");return v(),h(M,null,[t("table",pe,[s(re),t("tbody",fe,[(v(!0),h(M,null,E(d(l).users,(f,x)=>(v(),h("tr",{key:f.id||x},[t("td",he,[t("div",ve,[t("span",_e," UserID-00"+_(f.id)+"/01 ",1)])]),t("td",ge,[t("div",ye,[t("div",xe,[t("span",be,_(f.name.slice(0,2).toUpperCase()),1)]),t("div",null,[t("span",ke,_(f.name),1),t("span",we,_(f.email),1)])])]),t("td",Ue,[t("span",$e,_(f.role_names),1)]),t("td",Ve,_(f.departments_id),1),t("td",ze,_(f.created_at),1),t("td",Me,[t("div",qe,[s(k,{text:"Foydalanuvchini tahrirlash"},{default:u(()=>[s(i,{onClick:V=>n.$emit("edit-user",f),class:"p-2 rounded-full hover:bg-zinc-200 dark:hover:bg-zinc-600"},{default:u(()=>[s(d(G),{class:"w-5 h-5"})]),_:1},8,["onClick"])]),_:2},1024),s(k,{text:"Foydalanuvchini O'chirish"},{default:u(()=>[s(i,{onClick:V=>n.$emit("delete-user",f.id),class:"p-2 rounded-full hover:bg-zinc-200 dark:hover:bg-zinc-600"},{default:u(()=>[s(d(Q),{class:"w-5 h-5"})]),_:1},8,["onClick"])]),_:2},1024)])])]))),128))])]),s(se,{total:d(l).pagination.total,currentPage:d(l).pagination.current_page,lastPage:d(l).pagination.last_page,onChange:c},null,8,["total","currentPage","lastPage"])],64)}}},Se={key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40"},Be={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Ce={class:"flex items-center justify-between p-4 border-b dark:border-zinc-700"},Pe={class:"text-lg font-semibold text-dark"},De={class:"p-4 text-dark"},Te={key:0,class:"flex justify-end gap-3 p-4 border-t dark:border-zinc-700"},je={__name:"UModal",props:{modelValue:{type:Boolean,default:!1},title:{type:String,default:"Modal title"},width:{type:String,default:"max-w-lg w-full"}},emits:["update:modelValue"],setup(e,{emit:l}){const a=l,c=()=>a("update:modelValue",!1);return(n,p)=>{const i=b("UButton");return v(),h("div",null,[s(j,{name:"fade"},{default:u(()=>[e.modelValue?(v(),h("div",Se)):S("",!0)]),_:1}),s(j,{name:"fade-scale"},{default:u(()=>[e.modelValue?(v(),h("div",Be,[t("div",{class:X(["card-dark rounded shadow-2xl border transition-all duration-200",e.width])},[t("div",Ce,[t("h3",Pe,_(e.title),1),s(i,{onClick:c},{default:u(()=>[s(d(W),{size:"20"})]),_:1})]),t("div",De,[A(n.$slots,"default",{},void 0,!0)]),n.$slots.footer?(v(),h("div",Te,[A(n.$slots,"footer",{},void 0,!0)])):S("",!0)],2)])):S("",!0)]),_:3})])}}},N=H(je,[["__scopeId","data-v-9d71bdaa"]]),Ae=()=>$.get("/roles_list"),Ee=P("rolls",{state:()=>({rolls:[],selectedRoll:null,loading:!1,error:null}),actions:{async fetchAll(){try{this.loading=!0;const e=await Ae();this.rolls=e.data}catch(e){this.error=e,console.error("Rolllarni olishda xato:",e)}finally{this.loading=!1}}}}),Re={class:"flex flex-wrap -mx-2"},Ne={class:"w-full px-2 py-2 xl:w-1/2"},Ie={class:"w-full px-2 py-2 xl:w-1/2"},Le={class:"w-full px-2 py-2 xl:w-1/2"},He={class:"w-full px-2 py-2 xl:w-1/2"},Xe={class:"w-full px-2 py-2 xl:w-1/2"},Je={class:"w-full px-2 py-2 xl:w-1/2"},Oe={class:"w-full px-2 py-2 xl:w-1/2"},Ye={key:0,class:"w-full px-2 py-2 xl:w-1/2"},Ke={__name:"UserForm",setup(e,{expose:l}){const a=D(),c=Ee(),n=R(),p=g(!1),i=g(""),k=g("info"),f=g(0),x=g(!1),V={id:null,name:"",email:"",lastname:"",firstname:"",middlename:"",gender:"",departments_id:"",role_names:"",password:""},o=g({...V}),y=(w=null)=>{w?(x.value=!0,o.value={...w}):(x.value=!1,o.value={...V}),p.value=!0,c.fetchAll(),n.fetchAll()},q=()=>{p.value=!1},F=async()=>{console.log(o.value);try{const w=x.value?await a.editUser(o.value.id,o.value):await a.addUser(o.value);k.value=w?.success?"success":"error",i.value=w?.success?"Muvaffaqiyatli !":"Xatolik yuz berdi !"}catch{k.value="error",i.value="Server bilan aloqa xatosi !"}finally{f.value++,q()}};return l({openModal:y}),(w,r)=>{const I=b("UAlert"),C=b("UButton"),z=b("UInput"),T=b("USelect");return v(),h(M,null,[s(I,{message:i.value,type:k.value,trigger:f.value},null,8,["message","type","trigger"]),t("div",null,[s(C,{variant:"primary",onClick:r[0]||(r[0]=m=>y())},{default:u(()=>[...r[10]||(r[10]=[U(" Foydalanuvchi qo‘shish ",-1)])]),_:1}),s(N,{modelValue:p.value,"onUpdate:modelValue":r[9]||(r[9]=m=>p.value=m),width:"max-w-3xl",title:x.value?"Foydalanuvchini tahrirlash":"Foydalanuvchi qo‘shish"},{footer:u(()=>[s(C,{onClick:q,disabled:d(a).loading},{default:u(()=>[...r[11]||(r[11]=[U(" Bekor qilish ",-1)])]),_:1},8,["disabled"]),s(C,{type:"submit",form:"userForm",variant:"primary",loading:d(a).loading},{default:u(()=>[U(_(x.value?"Yangilash":"Saqlash"),1)]),_:1},8,["loading"])]),default:u(()=>[t("form",{id:"userForm",onSubmit:J(F,["prevent"]),class:"space-y-6"},[t("div",Re,[t("div",Ne,[s(z,{type:"text",modelValue:o.value.name,"onUpdate:modelValue":r[1]||(r[1]=m=>o.value.name=m),label:"Name",placeholder:"Enter name",required:""},null,8,["modelValue"])]),t("div",Ie,[s(z,{modelValue:o.value.email,"onUpdate:modelValue":r[2]||(r[2]=m=>o.value.email=m),type:"email",label:"Email",placeholder:"Enter email",required:""},null,8,["modelValue"])]),t("div",Le,[s(z,{type:"text",modelValue:o.value.lastname,"onUpdate:modelValue":r[3]||(r[3]=m=>o.value.lastname=m),label:"Last name",placeholder:"Enter last name"},null,8,["modelValue"])]),t("div",He,[s(z,{type:"text",modelValue:o.value.firstname,"onUpdate:modelValue":r[4]||(r[4]=m=>o.value.firstname=m),label:"First name",placeholder:"Enter first name",required:""},null,8,["modelValue"])]),t("div",Xe,[s(z,{type:"text",modelValue:o.value.middlename,"onUpdate:modelValue":r[5]||(r[5]=m=>o.value.middlename=m),label:"Middle name",placeholder:"Enter middle name",required:""},null,8,["modelValue"])]),t("div",Je,[s(T,{modelValue:o.value.departments_id,"onUpdate:modelValue":r[6]||(r[6]=m=>o.value.departments_id=m),options:d(n).departments,label:"Bo‘lim",placeholder:"Bo‘lim tanlang","option-label":"name_oz","option-value":"id",loading:d(n).loading,error:d(n).error},null,8,["modelValue","options","loading","error"])]),t("div",Oe,[s(T,{modelValue:o.value.role_names,"onUpdate:modelValue":r[7]||(r[7]=m=>o.value.role_names=m),options:d(c).rolls,label:"Bo‘lim",placeholder:"Rollni tanlang","option-label":"name","option-value":"id",loading:d(c).loading,error:d(c).error},null,8,["modelValue","options","loading","error"])]),x.value?S("",!0):(v(),h("div",Ye,[s(z,{modelValue:o.value.password,"onUpdate:modelValue":r[8]||(r[8]=m=>o.value.password=m),label:"Password",placeholder:"Enter password",required:""},null,8,["modelValue"])]))])],32)]),_:1},8,["modelValue","title"])])],64)}}},Ge={__name:"UserDelete",setup(e,{expose:l}){const a=g(""),c=g("info"),n=g(0),p=D(),i=g(!1),k=g(null),f=o=>{k.value=o,i.value=!0},x=()=>{i.value=!1},V=async()=>{try{await p.removeUser(k.value),i.value=!1,c.value="success",a.value="Muvaffaqiyatli!"}catch(o){console.error("Foydalanuvchini o‘chirishda xato:",o),c.value="error",a.value="Xatolik!"}n.value++};return l({openModal:f}),(o,y)=>{const q=b("UAlert"),F=b("UButton");return v(),h(M,null,[s(q,{message:a.value,type:c.value,trigger:n.value},null,8,["message","type","trigger"]),s(N,{modelValue:i.value,"onUpdate:modelValue":y[0]||(y[0]=w=>i.value=w),width:"max-w-md",title:"Foydalanuvchini o‘chirish"},{footer:u(()=>[s(F,{onClick:x,disabled:d(p).loading},{default:u(()=>[...y[1]||(y[1]=[U(" Bekor qilish ",-1)])]),_:1},8,["disabled"]),s(F,{variant:"danger",onClick:V,loading:d(p).loading},{default:u(()=>[...y[2]||(y[2]=[U(" O‘chirish ",-1)])]),_:1},8,["loading"])]),default:u(()=>[y[3]||(y[3]=t("div",{class:"space-y-4 text-center py-4"},[t("p",{class:"text-dark text-base"}," Siz rostdan ham bu foydalanuvchini o‘chirmoqchimisiz? ")],-1))]),_:1},8,["modelValue"])],64)}}},Qe={class:"min-h-[80vh] flex flex-col space-y-6"},We={class:"flex flex-col gap-5 sm:flex-row sm:items-center sm:justify-between"},Ze={class:"flex flex-col gap-3 sm:flex-row sm:items-center"},et={class:"flex-1 overflow-hidden shadow rounded card-dark border-2"},tt={class:"max-w-full overflow-x-auto custom-scrollbar"},st={__name:"UserdirectoryViews",setup(e){const l=g(),a=g();function c(p=null){l.value.openModal(p)}function n(p){a.value.openModal(p)}return(p,i)=>(v(),h("div",Qe,[t("div",We,[i[1]||(i[1]=t("h3",{class:"text-xl font-bold text-dark"}," Tizim foydalanuvchilari ",-1)),t("div",Ze,[s(O,{variant:"primary"},{default:u(()=>[...i[0]||(i[0]=[U("Filter",-1)])]),_:1}),s(Ke,{ref_key:"userFormRef",ref:l},null,512),s(Ge,{ref_key:"userDeleteRef",ref:a},null,512)])]),t("div",et,[t("div",tt,[s(Fe,{onEditUser:c,onDeleteUser:n})])])]))}};export{st as default};
