import{a as q,r as F,d as U,o as w,e as s,l as $,t as x,h as i,i as h,f as e,F as B,z as D,P as V,B as z,m as L,S as E,b as v,c as O,w as X,U as M,V as C,Q as H,W as Y,X as K}from"./index-C_KRwJd6.js";import{C as Q}from"./chevron-right-hglYsa0M.js";import{u as W}from"./user-BHq0Hx6z.js";import{U as T}from"./UModal-BMmYuYLD.js";/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=q("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=q("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=q("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),ee={class:"flex items-center w-full px-6 py-4 justify-between border-t-2 dark:border-zinc-600 dark:shadow-black"},te={class:"text-dark text-lg font-medium"},ae={class:"text-blue-500 font-extrabold"},se={class:"flex items-center"},le={class:"px-4 py-2 text-sm font-medium text-gray-700"},re={__name:"UPagination",props:{currentPage:{type:Number},lastPage:{type:Number},total:{type:Number}},setup(t){return(r,a)=>{const o=F("UButton");return w(),U("div",ee,[s("div",te,[a[2]||(a[2]=$("Mavjud barcha ma’lumotlar ro‘yxati ",-1)),s("span",ae,x(t.total),1),a[3]||(a[3]=$(" ta ",-1))]),s("div",se,[i(o,{variant:"primary",disabled:t.currentPage===1,onClick:a[0]||(a[0]=u=>r.$emit("change",t.currentPage-1))},{default:h(()=>[i(e(G),{class:"w-4 h-4"}),a[4]||(a[4]=s("span",{class:"hidden sm:inline"},"Avvalgi",-1))]),_:1},8,["disabled"]),s("span",le,x(t.currentPage)+" / "+x(t.lastPage),1),i(o,{variant:"primary",disabled:t.currentPage===t.lastPage,onClick:a[1]||(a[1]=u=>r.$emit("change",t.currentPage+1))},{default:h(()=>[a[5]||(a[5]=s("span",{class:"hidden sm:inline"},"Keyingi",-1)),i(e(Q),{class:"w-4 h-4"})]),_:1},8,["disabled"])])])}}},oe={class:"card-dark text-dark bg-zinc-100 border-b-2"},ne={__name:"TheadDock",setup(t){const r=[{key:"id",label:"Foydalanuvchi ID raqami"},{key:"name",label:"To‘liq ism va elektron pochta"},{key:"departments_id",label:"Foydalanuvchi roli"},{key:"role_names",label:"Bo‘lim yoki lavozim nomi"},{key:"created_at",label:"Yaratilgan sana va vaqt"},{key:"actions",label:"Amallar (tahrirlash / o‘chirish)"}];return(a,o)=>(w(),U("thead",oe,[s("tr",null,[(w(),U(B,null,D(r,u=>s("th",{key:u.key,class:"px-4 text-start py-3.5 sm:px-6"},x(u.label),1)),64))])]))}},ie=(t=1)=>V.get(`/user_list?page=${t}`),de=t=>V.post("/user_create",t),ue=t=>V.get(`/user_show/${t}`),ce=(t,r)=>V.put(`/user_update/${t}`,r),me=t=>V.delete(`/user_destroy/${t}`),j=z("users",{state:()=>({users:[],pagination:{current_page:1,last_page:1,total:0},selectedUser:null,loading:!1,error:null}),actions:{async fetchUsers(t=null){this.loading=!0,this.error=null;try{const r=t||this.pagination.current_page,a=await ie(r);console.log(a.data),this.users=a.data.data||a.data,this.pagination.current_page=a.data.current_page,this.pagination.last_page=a.data.last_page,this.pagination.total=a.data.total}catch(r){this.error=r.message||"Foydalanuvchilarni olishda xatolik yuz berdi"}finally{this.loading=!1}},async fetchUser(t){this.loading=!0;try{const r=await ue(t);this.selectedUser=r.data}catch(r){this.error=r.message}finally{this.loading=!1}},async addUser(t){this.loading=!0;try{return await de(t),await this.fetchUsers(),{success:!0}}catch(r){return this.error=r.message,{success:!1,error:r.message}}finally{this.loading=!1}},async editUser(t,r){this.loading=!0,this.error=null;try{const a=await ce(t,r);return await this.fetchUsers(),{success:!0,data:a.data}}catch(a){return this.error=a.response?.data?.message||a.message,console.error("Foydalanuvchini tahrirlashda xatolik:",this.error),{success:!1,error:this.error}}finally{this.loading=!1}},async removeUser(t){this.loading=!0;try{await me(t),await this.fetchUsers()}catch(r){this.error=r.message}finally{this.loading=!1}}}}),pe=()=>V.get("/department_list"),P=z("departments",{state:()=>({departments:[],selectedDepartment:null,loading:!1,error:null}),actions:{async fetchAll(){try{this.loading=!0;const t=await pe();this.departments=t.data}catch(t){this.error=t,console.error("Departmentlarni olishda xato:",t)}finally{this.loading=!1}}}}),fe={class:"min-w-full"},he={class:"divide-y dark:divide-zinc-600 divide-zinc-100"},ge={class:"px-4 py-3.5 sm:px-6"},ve={class:"flex items-center gap-3"},ye={class:"font-medium text-dark"},_e={class:"px-4 py-3.5 sm:px-6"},xe={class:"flex items-center gap-3"},be={class:"flex items-center justify-center w-10 h-10 rounded-full bg-zinc-200"},we=["src"],ke={class:"block font-medium text-dark"},Ue={class:"text-zinc-500 dark:text-zinc-400 text-sm"},$e={class:"px-4 py-3.5 sm:px-6 text-dark"},Ve={class:"rounded-full bg-blue-500 px-1 text-zinc-100"},Me={class:"px-4 py-3.5 sm:px-6 text-dark"},Fe={class:"px-4 py-3.5 sm:px-6 text-dark"},Be={class:"px-4 py-3.5 sm:px-6"},qe={class:"flex items-center"},ze={__name:"UserList",emits:["edit-user","delete-user"],setup(t){const r=j(),a=P();L(()=>{r.fetchUsers(),a.fetchAll()});const o=c=>{r.fetchUsers(c)},u=c=>{const m=a.departments.find(f=>f.department_id===c);return m?m.name_oz:"—"};return(c,m)=>{const f=F("UButton"),p=F("UTooltip");return w(),U(B,null,[s("table",fe,[i(ne),s("tbody",he,[(w(!0),U(B,null,D(e(r).users,(d,b)=>(w(),U("tr",{key:d.id||b},[s("td",ge,[s("div",ve,[s("span",ye," UserID-"+x(d.id),1)])]),s("td",_e,[s("div",xe,[s("div",be,[s("img",{src:e(W),class:"rounded-full h-10 w-10"},null,8,we)]),s("div",null,[s("span",ke,x(d.name),1),s("span",Ue,x(d.email),1)])])]),s("td",$e,[s("span",Ve,x(d.role),1)]),s("td",Me,x(u(d.department_id)),1),s("td",Fe,x(d.created_at),1),s("td",Be,[s("div",qe,[i(p,{text:"Foydalanuvchini tahrirlash"},{default:h(()=>[i(f,{onClick:g=>c.$emit("edit-user",d),class:"p-2 rounded-full hover:bg-zinc-200 dark:hover:bg-zinc-600"},{default:h(()=>[i(e(J),{class:"w-5 h-5"})]),_:1},8,["onClick"])]),_:2},1024),i(p,{text:"Foydalanuvchini o'chirish"},{default:h(()=>[i(f,{onClick:g=>c.$emit("delete-user",d.id),class:"p-2 rounded-full hover:bg-zinc-200 dark:hover:bg-zinc-600"},{default:h(()=>[i(e(Z),{class:"w-5 h-5"})]),_:1},8,["onClick"])]),_:2},1024)])])]))),128))])]),i(re,{total:e(r).pagination.total,currentPage:e(r).pagination.current_page,lastPage:e(r).pagination.last_page,onChange:o},null,8,["total","currentPage","lastPage"])],64)}}};function je(t,r={}){const a=E({});return{errors:a,validate:()=>{let c=!0;return Object.keys(r).forEach(m=>{const f=t[m],p=r[m];p.required&&(f===""||f===null||f===void 0)?(a[m]=p.message||"Majburiy maydon",c=!1):a[m]=""}),c},validateField:c=>{const m=r[c];if(!m)return!0;const f=t[c];return m.required&&(f===""||f===null||f===void 0)?(a[c]=m.message||"Majburiy maydon",!1):(a[c]="",!0)}}}const Pe=()=>V.get("/roles_list"),N=z("rolls",{state:()=>({rolls:[],selectedRoll:null,loading:!1,error:null}),actions:{async fetchAll(){try{this.loading=!0;const t=await Pe();this.rolls=t.data}catch(t){this.error=t,console.error("Rolllarni olishda xato:",t)}finally{this.loading=!1}}}});function A(){const t=j(),r=N(),a=P(),o=v(!1),u=v(!1),c=v(""),m=v("info"),f=v(0),p={id:null,name:"",email:"",lastname:"",firstname:"",middlename:"",gender:"",department_id:"",role:"",password:""},d=E({...p}),b={name:{required:!0,message:"Majburiy"},email:{required:!0,message:"Majburiy"},lastname:{required:!0,message:"Majburiy"},firstname:{required:!0,message:"Majburiy"},middlename:{required:!0,message:"Majburiy"},password:{required:!0,message:"Majburiy"},department_id:{required:!0,message:"Majburiy"},role:{required:!0,message:"Majburiy"}},{errors:g,validate:y,validateField:l}=je(d,b),k=()=>{Object.assign(d,p),Object.keys(g).forEach(_=>g[_]="")},n=(_,I="info")=>{c.value=_,m.value=I,f.value++},R=(_=null)=>{_?(u.value=!0,Object.assign(d,_)):(u.value=!1,k()),r.rolls.length||r.fetchAll(),a.departments.length||a.fetchAll(),o.value=!0},S=()=>{o.value=!1,k()};return{showModal:o,form:d,errors:g,isEdit:u,alertMessage:c,alertType:m,alertTrigger:f,openModal:R,closeModal:S,saveUser:async()=>{if(!y()){n("Iltimos, majburiy maydonlarni to‘ldiring!","error");return}try{const _=u.value?await t.editUser(d.id,d):await t.addUser(d);n(_?.success?"Muvaffaqiyatli!":"Xatolik yuz berdi!",_?.success?"success":"error"),_?.success&&S()}catch{n("Nimadir xato!","error")}},validateField:l}}const Se={class:"flex flex-wrap -mx-2"},Ce={class:"w-full px-2 py-2 xl:w-1/2"},De={class:"w-full px-2 py-2 xl:w-1/2"},Ee={class:"w-full px-2 py-2 xl:w-1/2"},Te={class:"w-full px-2 py-2 xl:w-1/2"},Ne={class:"w-full px-2 py-2 xl:w-1/2"},Ae={class:"w-full px-2 py-2 xl:w-1/2"},Re={class:"w-full px-2 py-2 xl:w-1/2"},Ie={class:"w-full px-2 py-2 xl:w-1/2"},Le={__name:"UserForm",setup(t,{expose:r}){const{showModal:a,form:o,errors:u,isEdit:c,saveUser:m,closeModal:f,validateField:p,openModal:d}=A(),b=N(),g=P();return r({openModal:d}),(y,l)=>{const k=F("UButton");return w(),O(T,{modelValue:e(a),"onUpdate:modelValue":l[17]||(l[17]=n=>H(a)?a.value=n:null),width:"max-w-3xl",title:e(c)?"Foydalanuvchini tahrirlash":"Foydalanuvchi qo‘shish"},{footer:h(()=>[i(k,{onClick:e(f)},{default:h(()=>[...l[18]||(l[18]=[$("Bekor qilish",-1)])]),_:1},8,["onClick"]),i(k,{type:"submit",form:"userForm",variant:"primary"},{default:h(()=>[$(x(e(c)?"Yangilash":"Saqlash"),1)]),_:1})]),default:h(()=>[s("form",{id:"userForm",onSubmit:l[16]||(l[16]=X((...n)=>e(m)&&e(m)(...n),["prevent"])),class:"space-y-6 p-4"},[s("div",Se,[s("div",Ce,[i(M,{modelValue:e(o).name,"onUpdate:modelValue":l[0]||(l[0]=n=>e(o).name=n),label:"Name",error:e(u).name,placeholder:"Enter name",onBlur:l[1]||(l[1]=n=>e(p)("name"))},null,8,["modelValue","error"])]),s("div",De,[i(M,{modelValue:e(o).lastname,"onUpdate:modelValue":l[2]||(l[2]=n=>e(o).lastname=n),label:"Last Name",error:e(u).lastname,placeholder:"Enter last name",onBlur:l[3]||(l[3]=n=>e(p)("lastname"))},null,8,["modelValue","error"])]),s("div",Ee,[i(M,{modelValue:e(o).firstname,"onUpdate:modelValue":l[4]||(l[4]=n=>e(o).firstname=n),label:"First Name",error:e(u).firstname,placeholder:"Enter first name",onBlur:l[5]||(l[5]=n=>e(p)("firstname"))},null,8,["modelValue","error"])]),s("div",Te,[i(M,{modelValue:e(o).middlename,"onUpdate:modelValue":l[6]||(l[6]=n=>e(o).middlename=n),label:"Middle Name",error:e(u).middlename,placeholder:"Enter middle name",onBlur:l[7]||(l[7]=n=>e(p)("middlename"))},null,8,["modelValue","error"])]),s("div",Ne,[i(M,{type:"email",modelValue:e(o).email,"onUpdate:modelValue":l[8]||(l[8]=n=>e(o).email=n),label:"Email",error:e(u).email,placeholder:"Enter email",onBlur:l[9]||(l[9]=n=>e(p)("email"))},null,8,["modelValue","error"])]),s("div",Ae,[i(M,{type:"password",modelValue:e(o).password,"onUpdate:modelValue":l[10]||(l[10]=n=>e(o).password=n),label:"Password",error:e(u).password,placeholder:"Enter password",onBlur:l[11]||(l[11]=n=>e(p)("password"))},null,8,["modelValue","error"])]),s("div",Re,[i(C,{modelValue:e(o).department_id,"onUpdate:modelValue":l[12]||(l[12]=n=>e(o).department_id=n),options:e(g).departments,label:"Bo‘lim","option-label":"name_oz","option-value":"department_id",loading:e(g).loading,error:e(u).department_id,onBlur:l[13]||(l[13]=n=>e(p)("department_id"))},null,8,["modelValue","options","loading","error"])]),s("div",Ie,[i(C,{modelValue:e(o).role,"onUpdate:modelValue":l[14]||(l[14]=n=>e(o).role=n),options:e(b).rolls,label:"Roll","option-label":"name","option-value":"name",loading:e(b).loading,error:e(u).role,onBlur:l[15]||(l[15]=n=>e(p)("role"))},null,8,["modelValue","options","loading","error"])])])],32)]),_:1},8,["modelValue","title"])}}},Oe={__name:"UserDelete",setup(t,{expose:r}){const a=v(""),o=v("info"),u=v(0),c=j(),m=v(!1),f=v(null),p=g=>{f.value=g,m.value=!0},d=()=>{m.value=!1},b=async()=>{try{await c.removeUser(f.value),m.value=!1,o.value="success",a.value="Muvaffaqiyatli!"}catch(g){console.error("Foydalanuvchini o‘chirishda xato:",g),o.value="error",a.value="Xatolik!"}u.value++};return r({openModal:p}),(g,y)=>{const l=F("UAlert"),k=F("UButton");return w(),U(B,null,[i(l,{message:a.value,type:o.value,trigger:u.value},null,8,["message","type","trigger"]),i(T,{modelValue:m.value,"onUpdate:modelValue":y[0]||(y[0]=n=>m.value=n),width:"max-w-md",title:"Foydalanuvchini o‘chirish"},{footer:h(()=>[i(k,{onClick:d,disabled:e(c).loading},{default:h(()=>[...y[1]||(y[1]=[$(" Bekor qilish ",-1)])]),_:1},8,["disabled"]),i(k,{variant:"danger",onClick:b,loading:e(c).loading},{default:h(()=>[...y[2]||(y[2]=[$(" O‘chirish ",-1)])]),_:1},8,["loading"])]),default:h(()=>[y[3]||(y[3]=s("div",{class:"space-y-4 text-center p-4"},[s("p",{class:"text-dark text-base"}," Siz rostdan ham bu foydalanuvchini o‘chirmoqchimisiz? ")],-1))]),_:1},8,["modelValue"])],64)}}},Xe={class:"min-h-[80vh] flex flex-col space-y-6 p-4"},He={class:"flex flex-col gap-5 sm:flex-row sm:items-center sm:justify-between"},Ye={class:"flex flex-col gap-3 sm:flex-row sm:items-center"},Ke={class:"flex-1 overflow-hidden shadow rounded card-dark border-2"},Qe={class:"max-w-full overflow-x-auto custom-scrollbar"},tt={__name:"UserdirectoryViews",setup(t){const{alertMessage:r,alertType:a,alertTrigger:o}=A(),u=v(),c=v();function m(p=null){u.value.openModal(p)}function f(p){c.value.openModal(p)}return(p,d)=>(w(),U("div",Xe,[i(Y,{message:e(r),type:e(a),trigger:e(o)},null,8,["message","type","trigger"]),s("div",He,[d[2]||(d[2]=s("h3",{class:"text-xl font-bold text-dark"},"Tizim foydalanuvchilari",-1)),s("div",Ye,[i(K,{variant:"primary",onClick:d[0]||(d[0]=b=>m())},{default:h(()=>[...d[1]||(d[1]=[$("Foydalanuvchi qo‘shish",-1)])]),_:1})])]),s("div",Ke,[s("div",Qe,[i(ze,{onEditUser:m,onDeleteUser:f})])]),i(Le,{ref_key:"userFormRef",ref:u},null,512),i(Oe,{ref_key:"userDeleteRef",ref:c},null,512)]))}};export{tt as default};
