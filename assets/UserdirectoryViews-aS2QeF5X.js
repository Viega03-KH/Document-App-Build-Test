import{a as B,r as y,d as x,o as w,e,l as U,t as _,h as s,i as h,f as i,F as M,z as T,L as $,B as S,m as N,b as f,w as j,Q as I}from"./index-74v6jW6D.js";import{C as L}from"./chevron-right-D4Qer9tb.js";import{u as H}from"./user-BHq0Hx6z.js";import{U as A}from"./UModal-CujgbGmW.js";/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=B("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=B("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=B("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),J={class:"flex items-center w-full px-6 py-4 justify-between border-t-2 dark:border-zinc-600 dark:shadow-black"},Q={class:"text-dark text-lg"},G={class:"text-blue-500 font-extrabold"},K={class:"flex items-center"},W={class:"px-4 py-2 text-sm font-medium text-gray-700"},Z={__name:"UPagination",props:{currentPage:{type:Number,required:!0},lastPage:{type:Number,required:!0},total:{type:Number,required:!0}},setup(t){return(l,a)=>{const m=y("UButton");return w(),x("div",J,[e("div",Q,[a[2]||(a[2]=U("Jadvalda mavjud barcha ma’lumotlar ustunlari ro‘yxati ",-1)),e("span",G,_(t.total),1),a[3]||(a[3]=U(" ta ",-1))]),e("div",K,[s(m,{variant:"primary",disabled:t.currentPage===1,onClick:a[0]||(a[0]=p=>l.$emit("change",t.currentPage-1))},{default:h(()=>[s(i(O),{class:"w-4 h-4"}),a[4]||(a[4]=e("span",{class:"hidden sm:inline"},"Previous",-1))]),_:1},8,["disabled"]),e("span",W,_(t.currentPage)+" / "+_(t.lastPage),1),s(m,{variant:"primary",disabled:t.currentPage===t.lastPage,onClick:a[1]||(a[1]=p=>l.$emit("change",t.currentPage+1))},{default:h(()=>[a[5]||(a[5]=e("span",{class:"hidden sm:inline"},"Next",-1)),s(i(L),{class:"w-4 h-4"})]),_:1},8,["disabled"])])])}}},ee={class:"card-dark text-dark bg-zinc-100 border-b-2"},te={__name:"TheadDock",setup(t){const l=[{key:"id",label:"Foydalanuvchi ID raqami"},{key:"name",label:"To‘liq ism va elektron pochta"},{key:"departments_id",label:"Foydalanuvchi roli"},{key:"role_names",label:"Bo‘lim yoki lavozim nomi"},{key:"created_at",label:"Yaratilgan sana va vaqt"},{key:"actions",label:"Amallar (tahrirlash / o‘chirish)"}];return(a,m)=>(w(),x("thead",ee,[e("tr",null,[(w(),x(M,null,T(l,p=>e("th",{key:p.key,class:"px-4 text-start py-3.5 sm:px-6"},_(p.label),1)),64))])]))}},ae=(t=1)=>$.get(`/user_list?page=${t}`),le=t=>$.post("/user_create",t),se=t=>$.get(`/user_show/${t}`),re=(t,l)=>$.put(`/user_update/${t}`,l),oe=t=>$.delete(`/user_destroy/${t}`),C=S("users",{state:()=>({users:[],pagination:{current_page:1,last_page:1,total:0},selectedUser:null,loading:!1,error:null}),actions:{async fetchUsers(t=null){this.loading=!0,this.error=null;try{const l=t||this.pagination.current_page,a=await ae(l);console.log(a.data),this.users=a.data.data||a.data,this.pagination.current_page=a.data.current_page,this.pagination.last_page=a.data.last_page,this.pagination.total=a.data.total}catch(l){this.error=l.message||"Foydalanuvchilarni olishda xatolik yuz berdi"}finally{this.loading=!1}},async fetchUser(t){this.loading=!0;try{const l=await se(t);this.selectedUser=l.data}catch(l){this.error=l.message}finally{this.loading=!1}},async addUser(t){this.loading=!0;try{return await le(t),await this.fetchUsers(),{success:!0}}catch(l){return this.error=l.message,{success:!1,error:l.message}}finally{this.loading=!1}},async editUser(t,l){this.loading=!0,this.error=null;try{const a=await re(t,l);return await this.fetchUsers(),{success:!0,data:a.data}}catch(a){return this.error=a.response?.data?.message||a.message,console.error("Foydalanuvchini tahrirlashda xatolik:",this.error),{success:!1,error:this.error}}finally{this.loading=!1}},async removeUser(t){this.loading=!0;try{await oe(t),await this.fetchUsers()}catch(l){this.error=l.message}finally{this.loading=!1}}}}),ne=()=>$.get("/department_list"),E=S("departments",{state:()=>({departments:[],selectedDepartment:null,loading:!1,error:null}),actions:{async fetchAll(){try{this.loading=!0;const t=await ne();this.departments=t.data}catch(t){this.error=t,console.error("Departmentlarni olishda xato:",t)}finally{this.loading=!1}}}}),ie={class:"min-w-full border-collapse"},de={class:"divide-y dark:divide-zinc-600 divide-zinc-100"},ue={class:"px-4 py-3.5 sm:px-6"},ce={class:"flex items-center gap-3"},me={class:"font-medium text-dark"},pe={class:"px-4 py-3.5 sm:px-6"},he={class:"flex items-center gap-3"},fe={class:"flex items-center justify-center w-10 h-10 rounded-full bg-[#fdf2fa]"},ve={class:"text-xs font-semibold text-[#dd2590]"},ge=["src"],_e={class:"block font-medium text-dark"},ye={class:"text-zinc-500 dark:text-zinc-400 text-sm"},xe={class:"px-4 py-3.5 sm:px-6 text-dark"},we={class:"rounded-full bg-blue-500 px-1 text-zinc-100"},be={class:"px-4 py-3.5 sm:px-6 text-dark"},Ue={class:"px-4 py-3.5 sm:px-6 text-dark"},ke={class:"px-4 py-3.5 sm:px-6"},$e={class:"flex items-center"},Ve={__name:"UserList",emits:["edit-user","delete-user"],setup(t){const l=C(),a=E();N(()=>{l.fetchUsers(),a.fetchAll()});const m=n=>{l.fetchUsers(n)},p=n=>{const d=a.departments.find(v=>v.department_id===n);return d?d.name_oz:"—"};return(n,d)=>{const v=y("UButton"),k=y("UTooltip");return w(),x(M,null,[e("table",ie,[s(te),e("tbody",de,[(w(!0),x(M,null,T(i(l).users,(c,V)=>(w(),x("tr",{key:c.id||V},[e("td",ue,[e("div",ce,[e("span",me," UserID-00"+_(c.id)+"/01 ",1)])]),e("td",pe,[e("div",he,[e("div",fe,[e("span",ve,[e("img",{src:i(H),class:"mr-2 overflow-hidden rounded-full h-10 w-10 border border-zinc-200 dark:border-zinc-800"},null,8,ge)])]),e("div",null,[e("span",_e,_(c.name),1),e("span",ye,_(c.email),1)])])]),e("td",xe,[e("span",we,_(c.role),1)]),e("td",be,_(p(c.departments_id)),1),e("td",Ue,_(c.created_at),1),e("td",ke,[e("div",$e,[s(k,{text:"Foydalanuvchini tahrirlash"},{default:h(()=>[s(v,{onClick:r=>n.$emit("edit-user",c),class:"p-2 rounded-full hover:bg-zinc-200 dark:hover:bg-zinc-600"},{default:h(()=>[s(i(X),{class:"w-5 h-5"})]),_:1},8,["onClick"])]),_:2},1024),s(k,{text:"Foydalanuvchini O'chirish"},{default:h(()=>[s(v,{onClick:r=>n.$emit("delete-user",c.id),class:"p-2 rounded-full hover:bg-zinc-200 dark:hover:bg-zinc-600"},{default:h(()=>[s(i(Y),{class:"w-5 h-5"})]),_:1},8,["onClick"])]),_:2},1024)])])]))),128))])]),s(Z,{total:i(l).pagination.total,currentPage:i(l).pagination.current_page,lastPage:i(l).pagination.last_page,onChange:m},null,8,["total","currentPage","lastPage"])],64)}}},ze=()=>$.get("/roles_list"),Me=S("rolls",{state:()=>({rolls:[],selectedRoll:null,loading:!1,error:null}),actions:{async fetchAll(){try{this.loading=!0;const t=await ze();this.rolls=t.data}catch(t){this.error=t,console.error("Rolllarni olishda xato:",t)}finally{this.loading=!1}}}}),qe={class:"flex flex-wrap -mx-2"},Fe={class:"w-full px-2 py-2 xl:w-1/2"},Pe={class:"w-full px-2 py-2 xl:w-1/2"},Be={class:"w-full px-2 py-2 xl:w-1/2"},Se={class:"w-full px-2 py-2 xl:w-1/2"},Ce={class:"w-full px-2 py-2 xl:w-1/2"},De={class:"w-full px-2 py-2 xl:w-1/2"},Te={class:"w-full px-2 py-2 xl:w-1/2"},Ae={class:"w-full px-2 py-2 xl:w-1/2"},Ee={__name:"UserForm",setup(t,{expose:l}){const a=C(),m=Me(),p=E(),n=f(!1),d=f(""),v=f("info"),k=f(0),c=f(!1),V={id:null,name:"",email:"",lastname:"",firstname:"",middlename:"",gender:"",department_id:"",role:"",password:""},r=f({...V}),g=(b=null)=>{b?(c.value=!0,r.value={...b}):(c.value=!1,r.value={...V}),n.value=!0,m.fetchAll(),p.fetchAll()},q=()=>{n.value=!1},F=async()=>{console.log(r.value);try{const b=c.value?await a.editUser(r.value.id,r.value):await a.addUser(r.value);v.value=b?.success?"success":"error",d.value=b?.success?"Muvaffaqiyatli !":"Xatolik yuz berdi !"}catch{v.value="error",d.value="Server bilan aloqa xatosi !"}finally{k.value++,q()}};return l({openModal:g}),(b,o)=>{const R=y("UAlert"),P=y("UButton"),z=y("UInput"),D=y("USelect");return w(),x(M,null,[s(R,{message:d.value,type:v.value,trigger:k.value},null,8,["message","type","trigger"]),e("div",null,[s(P,{variant:"primary",onClick:o[0]||(o[0]=u=>g())},{default:h(()=>[...o[10]||(o[10]=[U(" Foydalanuvchi qo‘shish ",-1)])]),_:1}),s(A,{modelValue:n.value,"onUpdate:modelValue":o[9]||(o[9]=u=>n.value=u),width:"max-w-3xl",title:c.value?"Foydalanuvchini tahrirlash":"Foydalanuvchi qo‘shish"},{footer:h(()=>[s(P,{onClick:q,disabled:i(a).loading},{default:h(()=>[...o[11]||(o[11]=[U(" Bekor qilish ",-1)])]),_:1},8,["disabled"]),s(P,{type:"submit",form:"userForm",variant:"primary",loading:i(a).loading},{default:h(()=>[U(_(c.value?"Yangilash":"Saqlash"),1)]),_:1},8,["loading"])]),default:h(()=>[e("form",{id:"userForm",onSubmit:j(F,["prevent"]),class:"space-y-6"},[e("div",qe,[e("div",Fe,[s(z,{type:"text",modelValue:r.value.name,"onUpdate:modelValue":o[1]||(o[1]=u=>r.value.name=u),label:"Name",placeholder:"Enter name",required:""},null,8,["modelValue"])]),e("div",Pe,[s(z,{modelValue:r.value.email,"onUpdate:modelValue":o[2]||(o[2]=u=>r.value.email=u),type:"email",label:"Email",placeholder:"Enter email",required:""},null,8,["modelValue"])]),e("div",Be,[s(z,{type:"text",modelValue:r.value.lastname,"onUpdate:modelValue":o[3]||(o[3]=u=>r.value.lastname=u),label:"Last name",placeholder:"Enter last name"},null,8,["modelValue"])]),e("div",Se,[s(z,{type:"text",modelValue:r.value.firstname,"onUpdate:modelValue":o[4]||(o[4]=u=>r.value.firstname=u),label:"First name",placeholder:"Enter first name",required:""},null,8,["modelValue"])]),e("div",Ce,[s(z,{type:"text",modelValue:r.value.middlename,"onUpdate:modelValue":o[5]||(o[5]=u=>r.value.middlename=u),label:"Middle name",placeholder:"Enter middle name",required:""},null,8,["modelValue"])]),e("div",De,[s(D,{modelValue:r.value.department_id,"onUpdate:modelValue":o[6]||(o[6]=u=>r.value.department_id=u),options:i(p).departments,label:"Bo‘lim",placeholder:"Bo‘lim tanlang","option-label":"name_oz","option-value":"department_id",loading:i(p).loading,error:i(p).error},null,8,["modelValue","options","loading","error"])]),e("div",Te,[s(D,{modelValue:r.value.role,"onUpdate:modelValue":o[7]||(o[7]=u=>r.value.role=u),options:i(m).rolls,label:"Bo‘lim",placeholder:"Rollni tanlang","option-label":"name","option-value":"name",loading:i(m).loading,error:i(m).error},null,8,["modelValue","options","loading","error"])]),e("div",Ae,[s(z,{modelValue:r.value.password,"onUpdate:modelValue":o[8]||(o[8]=u=>r.value.password=u),type:"password",label:"Password",placeholder:"Enter password",required:""},null,8,["modelValue"])])])],32)]),_:1},8,["modelValue","title"])])],64)}}},Re={__name:"UserDelete",setup(t,{expose:l}){const a=f(""),m=f("info"),p=f(0),n=C(),d=f(!1),v=f(null),k=r=>{v.value=r,d.value=!0},c=()=>{d.value=!1},V=async()=>{try{await n.removeUser(v.value),d.value=!1,m.value="success",a.value="Muvaffaqiyatli!"}catch(r){console.error("Foydalanuvchini o‘chirishda xato:",r),m.value="error",a.value="Xatolik!"}p.value++};return l({openModal:k}),(r,g)=>{const q=y("UAlert"),F=y("UButton");return w(),x(M,null,[s(q,{message:a.value,type:m.value,trigger:p.value},null,8,["message","type","trigger"]),s(A,{modelValue:d.value,"onUpdate:modelValue":g[0]||(g[0]=b=>d.value=b),width:"max-w-md",title:"Foydalanuvchini o‘chirish"},{footer:h(()=>[s(F,{onClick:c,disabled:i(n).loading},{default:h(()=>[...g[1]||(g[1]=[U(" Bekor qilish ",-1)])]),_:1},8,["disabled"]),s(F,{variant:"danger",onClick:V,loading:i(n).loading},{default:h(()=>[...g[2]||(g[2]=[U(" O‘chirish ",-1)])]),_:1},8,["loading"])]),default:h(()=>[g[3]||(g[3]=e("div",{class:"space-y-4 text-center py-4"},[e("p",{class:"text-dark text-base"}," Siz rostdan ham bu foydalanuvchini o‘chirmoqchimisiz? ")],-1))]),_:1},8,["modelValue"])],64)}}},Ne={class:"min-h-[80vh] flex flex-col space-y-6"},je={class:"flex flex-col gap-5 sm:flex-row sm:items-center sm:justify-between"},Ie={class:"flex flex-col gap-3 sm:flex-row sm:items-center"},Le={class:"flex-1 overflow-hidden shadow rounded card-dark border-2"},He={class:"max-w-full overflow-x-auto custom-scrollbar"},Qe={__name:"UserdirectoryViews",setup(t){const l=f(),a=f();function m(n=null){l.value.openModal(n)}function p(n){a.value.openModal(n)}return(n,d)=>(w(),x("div",Ne,[e("div",je,[d[1]||(d[1]=e("h3",{class:"text-xl font-bold text-dark"}," Tizim foydalanuvchilari ",-1)),e("div",Ie,[s(I,{variant:"primary"},{default:h(()=>[...d[0]||(d[0]=[U("Filter",-1)])]),_:1}),s(Ee,{ref_key:"userFormRef",ref:l},null,512),s(Re,{ref_key:"userDeleteRef",ref:a},null,512)])]),e("div",Le,[e("div",He,[s(Ve,{onEditUser:m,onDeleteUser:p})])])]))}};export{Qe as default};
