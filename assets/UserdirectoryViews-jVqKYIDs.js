import{a as T,e as x,o as g,f as a,F as z,z as C,t as _,u as D,L as q,r as w,i as s,j as h,g as e,h as U,N as I,B as M,b as O,m as P,w as R,H as X}from"./index-CJXrJkbj.js";import{_ as H}from"./UPagination-B2WzX-PT.js";import{a as B,X as A,u as Y,S as G}from"./usersStore-C4mLOTpv.js";import{u as J}from"./user-BHq0Hx6z.js";import"./chevron-right-2wuyl-Gm.js";/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=T("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),Q={class:"card-dark text-dark border-b"},W={__name:"TheadDock",setup(n){const m=[{key:"id",label:"Foydalanuvchi ID raqami"},{key:"name",label:"To‘liq ism va elektron pochta"},{key:"departments_id",label:"Foydalanuvchi roli"},{key:"role_names",label:"Bo‘lim yoki lavozim nomi"},{key:"created_at",label:"Yaratilgan sana va vaqt"},{key:"actions",label:"Amallar (tahrirlash / o‘chirish)"}];return(i,f)=>(g(),x("thead",Q,[a("tr",null,[(g(),x(z,null,C(m,l=>a("th",{key:l.key,class:"px-4 text-start py-3.5 sm:px-6"},_(l.label),1)),64))])]))}},Z={class:"max-w-xl max-h-xl"},ee={class:"justify-between border-b modal-card flex items-center p-4"},te={class:"justify-end border-t modal-card flex gap-2 p-4"},ae={__name:"UserDelete",props:{userId:{type:Number,required:!0}},setup(n){const m=n,i=B(),f=D(),l=q(),y=async()=>{try{await i.removeUser(m.userId),f.show("Foydalanuvchi muvaffaqiyatli o‘chirildi!","success"),l.close()}catch(v){f.show("Xatolik yuz berdi!","error"),console.error(v)}};return(v,d)=>{const b=w("UButton");return g(),x("div",Z,[a("div",ee,[d[2]||(d[2]=a("p",{class:"text-dark text-lg font-semibold"},"Foydalanuvchini o‘chirish",-1)),s(b,{variant:"hover",onClick:d[0]||(d[0]=t=>e(l).close())},{default:h(()=>[s(e(A),{class:"w-5 h-5"})]),_:1})]),d[5]||(d[5]=a("div",{class:"p-4 text-center space-y-4"},[a("p",{class:"text-base text-dark"}," Siz rostdan ham bu foydalanuvchini o‘chirmoqchimisiz? ")],-1)),a("div",te,[s(b,{onClick:d[1]||(d[1]=t=>e(l).close()),disabled:e(i).loading},{default:h(()=>[...d[3]||(d[3]=[U(" Bekor qilish ",-1)])]),_:1},8,["disabled"]),s(b,{variant:"danger",onClick:y,loading:e(i).loading},{default:h(()=>[...d[4]||(d[4]=[U(" O‘chirish ",-1)])]),_:1},8,["loading"])])])}}},se=()=>I.get("/roles_list"),le=M("rolls",{state:()=>({rolls:[],selectedRoll:null,loading:!1,error:null}),actions:{async fetchAll(){try{this.loading=!0;const n=await se();this.rolls=n.data}catch(n){this.error=n,console.error("Rolllarni olishda xato:",n)}finally{this.loading=!1}}}}),oe=()=>I.get("/department_list"),E=M("departments",{state:()=>({departments:[],selectedDepartment:null,loading:!1,error:null}),actions:{async fetchAll(){try{this.loading=!0;const n=await oe();this.departments=n.data}catch(n){this.error=n,console.error("Departmentlarni olishda xato:",n)}finally{this.loading=!1}}}}),re={class:"flex flex-col max-w-2xl"},ne={class:"justify-between border-b modal-card modal-border flex items-center p-4"},ie={class:"text-dark text-lg font-semibold"},de={class:"flex flex-wrap -mx-2 p-4"},me={class:"w-full px-2 py-2 xl:w-1/2"},ce={class:"w-full px-2 py-2 xl:w-1/2"},ue={class:"w-full px-2 py-2 xl:w-1/2"},pe={class:"w-full px-2 py-2 xl:w-1/2"},fe={class:"w-full px-2 py-2 xl:w-1/2"},he={class:"w-full px-2 py-2 xl:w-1/2"},_e={class:"w-full px-2 py-2 xl:w-1/2"},ye={class:"w-full px-2 py-2 xl:w-1/2"},xe={class:"justify-end border-t modal-card modal-border flex items-center p-4"},L={__name:"UserForm",props:{userId:{type:Number,default:null}},setup(n){const m=n,i=B(),f=le(),l=E(),y=D(),v=q(),d={id:null,name:"",email:"",lastname:"",firstname:"",middlename:"",department_id:null,role:"",password:""},b={name:{required:!0,message:"Ism majburiy"},email:{required:!0,message:"Email majburiy"},lastname:{required:!0,message:"Familiya majburiy"},firstname:{required:!0,message:"Sharif majburiy"},middlename:{required:!0,message:"Otasining ismi majburiy"},department_id:{required:!0,message:"Bo‘lim majburiy"},role:{required:!0,message:"Lavozim majburiy"},password:{required:!0,message:"Parol majburiy"}},{form:t,errors:p,validate:V,resetForm:$}=Y(d,b),c=O(!1);P(async()=>{if(f.rolls.length||await f.fetchAll(),l.departments.length||await l.fetchAll(),m.userId){c.value=!0,await i.fetchUser(m.userId);const o=i.selectedUser;console.log(o),o&&(t.id=o.id,t.name=o.name,t.lastname=o.lastname,t.firstname=o.firstname,t.middlename=o.middlename,t.email=o.email,t.department_id=o.department_id,t.role=o.role)}});const S=()=>{$(),v.close()},N=async()=>{if(V())try{const o={...t};o.password||delete o.password,c.value?await i.editUser(t.id,o):await i.addUser(o),S(),y.show("Barchasi muvaffaqiyatli!","success")}catch(o){y.show(o?.response?.data?.message||"Xatolik yuz berdi","error"),console.error(o)}};return(o,r)=>{const F=w("UButton"),k=w("UInput"),j=w("USelect");return g(),x("div",re,[a("div",ne,[a("p",ie,_(c.value?"Foydalanuvchini tahrirlash":"Foydalanuvchi qo‘shish"),1),s(F,{variant:"hover",onClick:S},{default:h(()=>[s(e(A),{class:"w-5 h-5"})]),_:1})]),a("form",{onSubmit:R(N,["prevent"]),class:"space-y-6"},[a("div",de,[a("div",me,[s(k,{modelValue:e(t).name,"onUpdate:modelValue":r[0]||(r[0]=u=>e(t).name=u),label:"Ism",placeholder:"Ismingizni kiriting",error:e(p).name},null,8,["modelValue","error"])]),a("div",ce,[s(k,{modelValue:e(t).email,"onUpdate:modelValue":r[1]||(r[1]=u=>e(t).email=u),label:"Email",placeholder:"Email manzilingizni kiriting",error:e(p).email},null,8,["modelValue","error"])]),a("div",ue,[s(k,{modelValue:e(t).lastname,"onUpdate:modelValue":r[2]||(r[2]=u=>e(t).lastname=u),label:"Familiya",placeholder:"Familiyangizni kiriting",error:e(p).lastname},null,8,["modelValue","error"])]),a("div",pe,[s(k,{modelValue:e(t).firstname,"onUpdate:modelValue":r[3]||(r[3]=u=>e(t).firstname=u),label:"Sharif",placeholder:"Sharifingizni kiriting",error:e(p).firstname},null,8,["modelValue","error"])]),a("div",fe,[s(k,{modelValue:e(t).middlename,"onUpdate:modelValue":r[4]||(r[4]=u=>e(t).middlename=u),label:"Otasining ismi",placeholder:"Otasining ismini kiriting",error:e(p).middlename},null,8,["modelValue","error"])]),a("div",he,[s(j,{modelValue:e(t).department_id,"onUpdate:modelValue":r[5]||(r[5]=u=>e(t).department_id=u),label:"Bo‘lim",options:e(l).departments,"option-label":"name_oz","option-value":"id",placeholder:"Otasining ismini kiriting",error:e(p).department_id},null,8,["modelValue","options","error"])]),a("div",_e,[s(j,{modelValue:e(t).role,"onUpdate:modelValue":r[6]||(r[6]=u=>e(t).role=u),label:"Lavozim",options:e(f).rolls,"option-label":"name","option-value":"name",placeholder:"Lavozimni tanlang",error:e(p).role},null,8,["modelValue","options","error"])]),a("div",ye,[s(k,{modelValue:e(t).password,"onUpdate:modelValue":r[7]||(r[7]=u=>e(t).password=u),type:"password",label:"Parol",placeholder:"Parolni yangilamoqchi bo‘lsangiz kiriting",error:e(p).password},null,8,["modelValue","error"])])]),a("div",xe,[s(F,{type:"button",onClick:S,disabled:e(i).loading},{default:h(()=>[...r[8]||(r[8]=[U(" Bekor qilish ",-1)])]),_:1},8,["disabled"]),s(F,{type:"submit",variant:"primary",loading:e(i).loading},{default:h(()=>[U(_(c.value?"Yangilash":"Saqlash"),1)]),_:1},8,["loading"])])],32)])}}},ge={class:"min-w-full"},ve={class:"divide-y dark:divide-gray-600 divide-gray-100"},be={class:"px-4 py-3.5 sm:px-6"},we={class:"font-medium text-dark"},ke={class:"px-4 py-3.5 sm:px-6 flex items-center gap-3"},Ue={class:"flex items-center justify-center w-10 h-10 rounded-full bg-gray-200"},Ve=["src"],$e={class:"block font-medium text-dark"},Se={class:"text-gray-500 dark:text-gray-400 text-sm"},qe={class:"px-4 py-3.5 sm:px-6"},Fe={class:"rounded-full bg-blue-500 px-1 text-gray-100"},ze={class:"px-4 py-3.5 sm:px-6"},Be={class:"px-4 py-3.5 sm:px-6"},je={class:"px-4 py-3.5 sm:px-6 flex gap-2"},Ce={__name:"UserList",setup(n){const m=B(),i=E(),f=q(),l=t=>m.fetchUsers(t),y=X(()=>{const t=new Map;return i.departments.forEach(p=>t.set(p.id,p.name_oz)),t}),v=t=>y.value.get(t)||"—";P(()=>{Promise.all([m.fetchUsers(),i.fetchAll()])});function d(t){f.open(ae,{userId:t})}function b(t=null){f.open(L,{userId:t})}return(t,p)=>{const V=w("UButton"),$=w("UTooltip");return g(),x(z,null,[a("table",ge,[s(W),a("tbody",ve,[(g(!0),x(z,null,C(e(m).users,c=>(g(),x("tr",{key:c.id},[a("td",be,[a("span",we,"UserID-"+_(c.id),1)]),a("td",ke,[a("div",Ue,[a("img",{src:c.avatar||e(J),class:"rounded-full h-10 w-10"},null,8,Ve)]),a("div",null,[a("span",$e,_(c.name),1),a("span",Se,_(c.email),1)])]),a("td",qe,[a("span",Fe,_(c.role),1)]),a("td",ze,_(v(c.department_id)),1),a("td",Be,_(c.created_at),1),a("td",je,[s($,{text:"Foydalanuvchini tahrirlash"},{default:h(()=>[s(V,{onClick:()=>b(c.id),variant:"hover"},{default:h(()=>[s(e(G),{class:"w-5 h-5"})]),_:1},8,["onClick"])]),_:2},1024),s($,{text:"Foydalanuvchini o‘chirish"},{default:h(()=>[s(V,{onClick:S=>d(c.id),variant:"hover"},{default:h(()=>[s(e(K),{class:"w-5 h-5"})]),_:1},8,["onClick"])]),_:2},1024)])]))),128))])]),s(H,{total:e(m).pagination.total,currentPage:e(m).pagination.current_page,lastPage:e(m).pagination.last_page,onChange:l},null,8,["total","currentPage","lastPage"])],64)}}},De={class:"min-h-[80vh] flex flex-col space-y-6 p-6"},Ie={class:"flex flex-col gap-5 sm:flex-row sm:items-center sm:justify-between"},Me={class:"flex-1 overflow-hidden shadow rounded card-dark border"},Pe={class:"max-w-full overflow-x-auto custom-scrollbar"},Oe={__name:"UserdirectoryViews",setup(n){const m=q();function i(){m.open(L)}return(f,l)=>{const y=w("UButton");return g(),x("div",De,[a("div",Ie,[l[2]||(l[2]=a("h3",{class:"text-xl font-bold text-dark"}," Tizim foydalanuvchilari ",-1)),s(y,{variant:"primary",onClick:l[0]||(l[0]=v=>i())},{default:h(()=>[...l[1]||(l[1]=[U("Foydalanuvchi qo‘shish",-1)])]),_:1})]),a("div",Me,[a("div",Pe,[s(Ce)])])])}}};export{Oe as default};
