import{u as R,_ as $}from"./OrganizationForm-0yJNAwmz.js";import{u as B}from"./doctypeStore-DSXDoVxz.js";import{u as M}from"./deliveryStore-BP9wpT1q.js";import{u as T}from"./subjectStore-CCQyzlsA.js";import{u as I}from"./dockstatusStore-BMsRw9jQ.js";import{k as F,G as O,r as b,a as g,o as f,b as d,g as s,f as c,h as j,R as X,J as V,m as E,q as H,v as _,c as D,p as U,d as q,C as A,j as S,F as P,x as N,E as v,A as z}from"./index-CDbZ6Fa9.js";import{P as Y}from"./useFormValidate-kLZtjoVo.js";/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=F("arrow-down-to-line",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=F("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=F("paperclip",[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=F("trash",[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),Q={class:"flex flex-col w-full"},Z={class:"flex flex-row items-end justify-between gap-4"},ee={class:"grid grid-cols-1 md:grid-cols-3 gap-[32px] flex-1 py-8"},te={class:"flex py-[16px]"},Fe={__name:"DockFormFields",props:{model:{type:Object,required:!0},errors:{type:Object,default:()=>({})}},setup(e){const t=O();function l(){t.open($)}const u=R(),r=B(),m=M();I();const y=T();return(k,o)=>{const i=b("USelect"),p=b("UButton"),h=b("UInput"),C=b("UDatePicker"),n=b("UTextarea");return f(),g("div",Q,[d("div",Z,[s(i,{modelValue:e.model.organization_id,"onUpdate:modelValue":o[0]||(o[0]=a=>e.model.organization_id=a),options:c(u).organizations,label:"Tashkilot",placeholder:"Tashkilotni tanlang","option-label":"name_oz","option-value":"id",loading:c(u).loading,error:e.errors?.organization_id},null,8,["modelValue","options","loading","error"]),s(p,{onClick:l,variant:"primary",customClass:"w-1/4"},{default:j(()=>[s(c(Y),{"stroke-width":3}),o[12]||(o[12]=d("span",{class:"px-2"},"Tashkelot qo'shish",-1))]),_:1})]),d("div",ee,[s(i,{modelValue:e.model.doc_type_id,"onUpdate:modelValue":o[1]||(o[1]=a=>e.model.doc_type_id=a),options:c(r).doctypes,label:"Hujjat turi",placeholder:"Hujjat turini tanlang","option-label":"name_oz","option-value":"id",loading:c(r).loading,error:e.errors?.doc_type_id},null,8,["modelValue","options","loading","error"]),s(i,{modelValue:e.model.delivery_method_id,"onUpdate:modelValue":o[2]||(o[2]=a=>e.model.delivery_method_id=a),options:c(m).list,label:"Yetkazish usuli",placeholder:"Yetkazish usulini tanlang","option-label":"name_oz","option-value":"id",loading:c(m).loading,error:e.errors?.delivery_method_id},null,8,["modelValue","options","loading","error"]),s(i,{modelValue:e.model.subject_id,"onUpdate:modelValue":o[3]||(o[3]=a=>e.model.subject_id=a),options:c(y).subjects,label:"Mavzu",placeholder:"Mavzuni tanlang","option-label":"name_oz","option-value":"id",loading:c(y).loading,error:e.errors?.subject_id},null,8,["modelValue","options","loading","error"]),s(h,{modelValue:e.model.incoming_number,"onUpdate:modelValue":o[4]||(o[4]=a=>e.model.incoming_number=a),label:"Kiruvchi raqam",placeholder:"Kiruvchi raqamni kiriting",error:e.errors?.incoming_number},null,8,["modelValue","error"]),s(h,{modelValue:e.model.outgoing_number,"onUpdate:modelValue":o[5]||(o[5]=a=>e.model.outgoing_number=a),label:"Chiquvchi raqam",placeholder:"Chiquvchi raqamni kiriting",error:e.errors?.outgoing_number},null,8,["modelValue","error"]),s(h,{modelValue:e.model.document_name,"onUpdate:modelValue":o[6]||(o[6]=a=>e.model.document_name=a),label:"Hujjat nomi",placeholder:"Hujjat nomini kiriting",error:e.errors?.document_name},null,8,["modelValue","error"]),s(h,{modelValue:e.model.signed_by,"onUpdate:modelValue":o[7]||(o[7]=a=>e.model.signed_by=a),label:"Imzolovchi",placeholder:"Imzolovchini kiriting",error:e.errors?.signed_by},null,8,["modelValue","error"]),s(h,{modelValue:e.model.executor,"onUpdate:modelValue":o[8]||(o[8]=a=>e.model.executor=a),label:"Ijrochi",placeholder:"Ijrochini kiriting",error:e.errors?.executor},null,8,["modelValue","error"]),s(C,{modelValue:e.model.doc_date,"onUpdate:modelValue":o[9]||(o[9]=a=>e.model.doc_date=a),label:"Bajarish muddati",placeholder:"Sanani tanlang",error:e.errors?.doc_date,type:"date"},null,8,["modelValue","error"]),s(h,{modelValue:e.model.phone_number,"onUpdate:modelValue":o[10]||(o[10]=a=>e.model.phone_number=a),label:"Telefon raqami",placeholder:"+998 XX-XXX-XX-XX",error:e.errors?.phone_number},null,8,["modelValue","error"])]),d("div",te,[s(n,{modelValue:e.model.short_content,"onUpdate:modelValue":o[11]||(o[11]=a=>e.model.short_content=a),label:"Qisqacha mazmun",placeholder:"Hujjatning qisqacha mazmunini kiriting",error:e.errors?.short_content},null,8,["modelValue","error"])])])}}},oe={class:"flex items-center justify-between border border-[#EAECF0] card-dark shadow-sm rounded-[12px] px-4 py-3 hover:bg-[#4076FF0D] dark:hover:bg-gray-600 cursor-pointer"},le={class:"flex items-center gap-4 min-w-0"},ae=["title"],re={class:"flex items-center gap-2 flex-shrink-0 ml-4"},ne={__name:"UFileCard",props:{file:{type:Object,required:!0},showDelete:{type:Boolean,default:!1}},emits:["remove"],setup(e,{emit:t}){const l=e,u=t;X();const r=V(()=>{const n=l.file;return n&&(n.name||n.url?.split("/").pop())||"file"}),m=V(()=>r.value?.split(".").pop()?.toLowerCase()||""),y=V(()=>m.value==="pdf"?"bg-red-500":["doc","docx"].includes(m.value)?"bg-blue-500":"bg-gray-500"),k=V(()=>m.value==="pdf"),o=[],i=V(()=>{const n=l.file;return n?n.url?n.url:n instanceof File?(n._objectURL||(n._objectURL=URL.createObjectURL(n),o.push(n._objectURL)),n._objectURL):"":""});E(()=>{o.forEach(n=>URL.revokeObjectURL(n))});const p=()=>{k.value&&window.open(i.value,"_blank","noopener,noreferrer")},h=async()=>{const n=i.value;try{const x=await(await fetch(n)).blob(),L=URL.createObjectURL(x),w=document.createElement("a");w.href=L,w.download=r.value,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(L)}catch(a){console.error("Download error:",a)}},C=()=>{l.file.id?u("remove",{id:l.file.id}):u("remove",l.file)};return(n,a)=>{const x=b("UButton");return f(),g("div",oe,[d("div",le,[d("div",{class:H(["flex items-center justify-center text-white font-semibold w-16 px-4 py-4 rounded-[12px] shrink-0",y.value])},_(m.value.toUpperCase()),3),d("p",{class:"w-4/5 text-dark font-semibold truncate",title:r.value},_(r.value),9,ae)]),d("div",re,[k.value?(f(),D(x,{key:0,class:"p-2 rounded-full hover:bg-blue-200",onClick:p},{default:j(()=>[s(c(W),{strokeWidth:"2.5",class:"w-5 h-5 text-gray-500"})]),_:1})):U("",!0),s(x,{onClick:h,class:"p-2 rounded-full hover:bg-blue-200",title:"Yuklab olish"},{default:j(()=>[s(c(K),{class:"w-5 h-5 text-gray-500"})]),_:1}),e.showDelete?(f(),D(x,{key:1,onClick:C,class:"p-2 rounded-full hover:bg-blue-200",title:"Oâ€˜chirish"},{default:j(()=>[s(c(J),{class:"w-5 h-5 text-gray-500"})]),_:1})):U("",!0)])])}}},se={class:"flex flex-col gap-2 w-full"},ie={key:0,class:"text-md font-bold text-dark"},de={class:"relative border items-center border-[rgba(226,230,245,1)] shadow-sm card-dark rounded-[16px] px-[24px] py-[12px] outline-none transition duration-200 w-full"},ue={class:"flex flex-col items-center justify-center text-gray-400 dark:text-gray-300 transition-transform duration-150"},ce=["multiple","accept"],me={key:1,class:"text-md text-red-500 italic py-2"},he={key:2,class:"space-y-2"},Ce={__name:"UFileInput",props:{label:String,multiple:{type:Boolean,default:!1},accept:{type:String,default:""},modelValue:{type:Array,default:()=>[]},error:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:t}){const l=e,u=t,r=q([...l.modelValue]),m=q(null);A(()=>l.modelValue,o=>{r.value=[...o]});const y=o=>{const i=Array.from(o.target.files);if(!i.length)return;const p=i.map(h=>Object.assign(h,{isLocal:!0}));r.value=l.multiple?[...r.value,...p]:p,u("update:modelValue",r.value),u("change",r.value),m.value.value=""},k=o=>{r.value=r.value.filter(i=>i!==o),u("update:modelValue",r.value)};return(o,i)=>(f(),g("div",se,[e.label?(f(),g("label",ie,_(e.label),1)):U("",!0),d("div",de,[d("div",ue,[s(c(G),{"stroke-width":"1",class:"w-10 h-10"}),i[0]||(i[0]=d("p",{class:"text-sm text-gray-700 dark:text-gray-200 text-center leading-snug"},[S(" Faylni shu yerga "),d("span",{class:"text-blue-600 font-semibold"},"tortib keltiring"),S(),d("br"),S(" yoki "),d("span",{class:"text-blue-600 font-semibold"},"tanlang")],-1))]),d("input",{ref_key:"fileInput",ref:m,type:"file",class:"absolute inset-0 opacity-0 cursor-pointer",multiple:e.multiple,accept:e.accept,onChange:y},null,40,ce)]),e.error?(f(),g("p",me,_(e.error),1)):U("",!0),r.value.length?(f(),g("div",he,[(f(!0),g(P,null,N(r.value,p=>(f(),D(ne,{key:p.name,file:p,"show-delete":!0,onRemove:k},null,8,["file"]))),128))])):U("",!0)]))}},fe=(e=1,t)=>{const l={page:e};return t!=null&&(l.status_id=t),v.get("/incoming_document_list",{params:l})},pe=(e,t)=>v.post(`/incoming_document_create_or_update/${e}`,t),ge=e=>v.get(`/incoming_document_show/${e}`),Se=z("dock",{state:()=>({docks:[],pagination:{current_page:1,last_page:1,total:0},selectedDock:null,loading:!1,error:null,status_id:null}),actions:{async fetchAll(e=1){this.loading=!0,this.error=null;try{const t=await fe(e,this.status_id);this.docks=t.data.data,this.pagination.current_page=t.data.current_page,this.pagination.last_page=t.data.last_page,this.pagination.total=t.data.total}catch(t){this.error=t.message}finally{this.loading=!1}},async createDock(e,t){this.loading=!0,this.error=null;try{const l=await pe(e,t);l.data.success?await this.fetchAll():this.error=l.data.message}catch(l){this.error=l?.message,console.error(l)}finally{this.loading=!1}},async fetchDock(e){this.loading=!0;try{const t=await ge(e);return this.selectedDock=t.data,t.data}catch(t){this.error=t.message}finally{this.loading=!1}}}}),ye=(e,t)=>v.post(`file-upload?task_id=${t}`,e,{headers:{"Content-Type":"multipart/form-data"}}),De=z("fileupload",{state:()=>({files:[],response:[],error:null}),actions:{setFiles(e){this.files=e},async upload(e){if(this.files.length){this.response=[],this.error=null;try{const t=new FormData;this.files.forEach(u=>{t.append("files[]",u)});const l=await ye(t,e);return this.response=l.data||[],console.log(l.data),this.response}catch(t){throw this.error=t.response?.data||t.message||t,console.log(t.response?.data),this.error}}},clear(){this.files=[],this.response=[],this.error=null}}}),be=e=>v.post("/document_file_create",e),ve=e=>v.delete(`/document_file_delete/${e}`),ze=z("documentfilecreate",{state:()=>({response:null,error:null,loading:!1}),actions:{async createFiles(e,t){if(!(!e||!t?.length)){this.loading=!0,this.error=null;try{const l={incoming_documents_id:e,files:t.map(r=>({url:r.url,type:r.type||"main"}))},u=await be(l);return this.response=u.data,u.data}catch(l){throw this.error=l.response?.data||l.message,this.error}finally{this.loading=!1}}},async deleteFile(e){if(e){this.loading=!0,this.error=null;try{return(await ve(e)).data}catch(t){throw this.error=t.response?.data||t.message,t}finally{this.loading=!1}}},clear(){this.response=null,this.error=null,this.loading=!1}}});export{Fe as _,De as a,ze as b,Ce as c,ne as d,Se as u};
