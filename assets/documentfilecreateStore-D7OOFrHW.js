import{u as $,_ as B}from"./OrganizationForm-CyVKB97Q.js";import{u as D}from"./doctypeStore-OJkowOX_.js";import{u as T}from"./deliveryStore-CSQm_Ra5.js";import{u as H}from"./subjectStore-7JCAFQtX.js";import{k as S,E as F,A as q,G as I,r as w,a as y,o as f,b as d,g as r,f as i,h as U,Q as O,J as V,m as X,q as _,v as C,c as L,p as j,d as R,C as E,j as z,F as A,x as N}from"./index-m9snDiDH.js";import{P}from"./useFormValidate-BonXcG65.js";/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=S("arrow-down-to-line",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=S("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=S("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=S("paperclip",[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]]);/**
 * @license lucide-vue-next v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=S("trash",[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),J=()=>F.get("task_status_list"),Z=q("status",{state:()=>({status:[],selectedStatus:null,loading:!1,error:null}),actions:{async fetchAll(){try{this.loading=!0;const e=await J();this.status=e.data}catch(e){this.error=e,console.error("Status olishda xato:",e)}finally{this.loading=!1}}}}),ee={class:"flex flex-col w-full"},te={class:"flex flex-row items-end justify-between gap-4"},oe={class:"grid grid-cols-1 md:grid-cols-3 gap-[32px] flex-1 py-8"},le={class:"flex py-[16px]"},je={__name:"DockFormFields",props:{model:{type:Object,required:!0},errors:{type:Object,default:()=>({})}},setup(e){const l=I();function s(){l.open(B)}const u=$(),a=D(),m=T(),b=Z(),g=H();return(h,t)=>{const c=w("USelect"),v=w("UButton"),p=w("UInput"),n=w("UTextarea");return f(),y("div",ee,[d("div",te,[r(c,{modelValue:e.model.organization_id,"onUpdate:modelValue":t[0]||(t[0]=o=>e.model.organization_id=o),options:i(u).organizations,label:"Tashkilot",placeholder:"Tashkilotni tanlang","option-label":"name_oz","option-value":"id",loading:i(u).loading,error:e.errors?.organization_id},null,8,["modelValue","options","loading","error"]),r(v,{onClick:s,variant:"primary",customClass:"w-1/4"},{default:U(()=>[r(i(P),{"stroke-width":3}),t[13]||(t[13]=d("span",{class:"px-2"},"Tashkelot qo'shish",-1))]),_:1})]),d("div",oe,[r(c,{modelValue:e.model.doc_type_id,"onUpdate:modelValue":t[1]||(t[1]=o=>e.model.doc_type_id=o),options:i(a).doctypes,label:"Hujjat turi",placeholder:"Hujjat turini tanlang","option-label":"name_oz","option-value":"id",loading:i(a).loading,error:e.errors?.doc_type_id},null,8,["modelValue","options","loading","error"]),r(c,{modelValue:e.model.delivery_method_id,"onUpdate:modelValue":t[2]||(t[2]=o=>e.model.delivery_method_id=o),options:i(m).list,label:"Yetkazish usuli",placeholder:"Yetkazish usulini tanlang","option-label":"name_oz","option-value":"id",loading:i(m).loading,error:e.errors?.delivery_method_id},null,8,["modelValue","options","loading","error"]),r(c,{modelValue:e.model.subject_id,"onUpdate:modelValue":t[3]||(t[3]=o=>e.model.subject_id=o),options:i(g).subjects,label:"Mavzu",placeholder:"Mavzuni tanlang","option-label":"name_oz","option-value":"id",loading:i(g).loading,error:e.errors?.subject_id},null,8,["modelValue","options","loading","error"]),r(c,{modelValue:e.model.status_id,"onUpdate:modelValue":t[4]||(t[4]=o=>e.model.status_id=o),options:i(b).status,label:"Holati",placeholder:"Holatni tanlang","option-label":"name_oz","option-value":"id",loading:i(b).loading,error:e.errors?.status_id},null,8,["modelValue","options","loading","error"]),r(p,{modelValue:e.model.incoming_number,"onUpdate:modelValue":t[5]||(t[5]=o=>e.model.incoming_number=o),label:"Kiruvchi raqam",placeholder:"Kiruvchi raqamni kiriting",error:e.errors?.incoming_number},null,8,["modelValue","error"]),r(p,{modelValue:e.model.outgoing_number,"onUpdate:modelValue":t[6]||(t[6]=o=>e.model.outgoing_number=o),label:"Chiquvchi raqam",placeholder:"Chiquvchi raqamni kiriting",error:e.errors?.outgoing_number},null,8,["modelValue","error"]),r(p,{modelValue:e.model.document_name,"onUpdate:modelValue":t[7]||(t[7]=o=>e.model.document_name=o),label:"Hujjat nomi",placeholder:"Hujjat nomini kiriting",error:e.errors?.document_name},null,8,["modelValue","error"]),r(p,{modelValue:e.model.signed_by,"onUpdate:modelValue":t[8]||(t[8]=o=>e.model.signed_by=o),label:"Imzolovchi",placeholder:"Imzolovchini kiriting",error:e.errors?.signed_by},null,8,["modelValue","error"]),r(p,{modelValue:e.model.executor,"onUpdate:modelValue":t[9]||(t[9]=o=>e.model.executor=o),label:"Ijrochi",placeholder:"Ijrochini kiriting",error:e.errors?.executor},null,8,["modelValue","error"]),r(p,{modelValue:e.model.doc_date,"onUpdate:modelValue":t[10]||(t[10]=o=>e.model.doc_date=o),label:"Bajarish muddati",placeholder:"Sanani tanlang",error:e.errors?.doc_date,type:"date"},{right:U(()=>[r(i(K),{"stroke-width":"2.5",class:"text-gray-400"})]),_:1},8,["modelValue","error"]),r(p,{modelValue:e.model.phone_number,"onUpdate:modelValue":t[11]||(t[11]=o=>e.model.phone_number=o),label:"Telefon raqami",placeholder:"+998 XX XXX XX XX",error:e.errors?.phone_number},null,8,["modelValue","error"])]),d("div",le,[r(n,{modelValue:e.model.short_content,"onUpdate:modelValue":t[12]||(t[12]=o=>e.model.short_content=o),label:"Qisqacha mazmun",placeholder:"Hujjatning qisqacha mazmunini kiriting",error:e.errors?.short_content},null,8,["modelValue","error"])])])}}},ae={class:"flex items-center justify-between border border-[#EAECF0] card-dark shadow-sm rounded-[12px] px-4 py-3 hover:bg-[#4076FF0D] dark:hover:bg-gray-600 cursor-pointer"},re={class:"flex items-center gap-4 min-w-0"},ne=["title"],se={class:"flex items-center gap-2 flex-shrink-0 ml-4"},ie={__name:"UFileCard",props:{file:{type:Object,required:!0},showDelete:{type:Boolean,default:!1}},emits:["remove"],setup(e,{emit:l}){const s=e,u=l;O();const a=V(()=>{const n=s.file;return n&&(n.name||n.url?.split("/").pop())||"file"}),m=V(()=>a.value?.split(".").pop()?.toLowerCase()||""),b=V(()=>m.value==="pdf"?"bg-red-500":["doc","docx"].includes(m.value)?"bg-blue-500":"bg-gray-500"),g=V(()=>m.value==="pdf"),h=[],t=V(()=>{const n=s.file;return n?n.url?n.url:n instanceof File?(n._objectURL||(n._objectURL=URL.createObjectURL(n),h.push(n._objectURL)),n._objectURL):"":""});X(()=>{h.forEach(n=>URL.revokeObjectURL(n))});const c=()=>{g.value&&window.open(t.value,"_blank","noopener,noreferrer")},v=async()=>{const n=t.value;try{const k=await(await fetch(n)).blob(),M=URL.createObjectURL(k),x=document.createElement("a");x.href=M,x.download=a.value,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(M)}catch(o){console.error("Download error:",o)}},p=()=>{s.file.id?u("remove",{id:s.file.id}):u("remove",s.file)};return(n,o)=>{const k=w("UButton");return f(),y("div",ae,[d("div",re,[d("div",{class:_(["flex items-center justify-center text-white font-semibold w-16 px-4 py-4 rounded-[12px] shrink-0",b.value])},C(m.value.toUpperCase()),3),d("p",{class:"w-4/5 text-dark font-semibold truncate",title:a.value},C(a.value),9,ne)]),d("div",se,[g.value?(f(),L(k,{key:0,class:"p-2 rounded-full hover:bg-blue-200",onClick:c},{default:U(()=>[r(i(Q),{strokeWidth:"2.5",class:"w-5 h-5 text-gray-500"})]),_:1})):j("",!0),r(k,{onClick:v,class:"p-2 rounded-full hover:bg-blue-200",title:"Yuklab olish"},{default:U(()=>[r(i(Y),{class:"w-5 h-5 text-gray-500"})]),_:1}),e.showDelete?(f(),L(k,{key:1,onClick:p,class:"p-2 rounded-full hover:bg-blue-200",title:"Oâ€˜chirish"},{default:U(()=>[r(i(G),{class:"w-5 h-5 text-gray-500"})]),_:1})):j("",!0)])])}}},de={class:"flex flex-col gap-2 w-full"},ue={key:0,class:"text-md font-bold text-dark"},ce={class:"relative border items-center border-[rgba(226,230,245,1)] shadow-sm card-dark rounded-[16px] px-[24px] py-[12px] outline-none transition duration-200 w-full"},me={class:"flex flex-col items-center justify-center text-gray-400 dark:text-gray-300 transition-transform duration-150"},he=["multiple","accept"],fe={key:1,class:"text-md text-red-500 italic py-2"},pe={key:2,class:"space-y-2"},Se={__name:"UFileInput",props:{label:String,multiple:{type:Boolean,default:!1},accept:{type:String,default:""},modelValue:{type:Array,default:()=>[]},error:{type:String,default:""}},emits:["update:modelValue","change"],setup(e,{emit:l}){const s=e,u=l,a=R([...s.modelValue]),m=R(null);E(()=>s.modelValue,h=>{a.value=[...h]});const b=h=>{const t=Array.from(h.target.files);if(!t.length)return;const c=t.map(v=>Object.assign(v,{isLocal:!0}));a.value=s.multiple?[...a.value,...c]:c,u("update:modelValue",a.value),u("change",a.value),m.value.value=""},g=h=>{a.value=a.value.filter(t=>t!==h),u("update:modelValue",a.value)};return(h,t)=>(f(),y("div",de,[e.label?(f(),y("label",ue,C(e.label),1)):j("",!0),d("div",ce,[d("div",me,[r(i(W),{"stroke-width":"1",class:"w-10 h-10"}),t[0]||(t[0]=d("p",{class:"text-sm text-gray-700 dark:text-gray-200 text-center leading-snug"},[z(" Faylni shu yerga "),d("span",{class:"text-blue-600 font-semibold"},"tortib keltiring"),z(),d("br"),z(" yoki "),d("span",{class:"text-blue-600 font-semibold"},"tanlang")],-1))]),d("input",{ref_key:"fileInput",ref:m,type:"file",class:"absolute inset-0 opacity-0 cursor-pointer",multiple:e.multiple,accept:e.accept,onChange:b},null,40,he)]),e.error?(f(),y("p",fe,C(e.error),1)):j("",!0),a.value.length?(f(),y("div",pe,[(f(!0),y(A,null,N(a.value,c=>(f(),L(ie,{key:c.name,file:c,"show-delete":!0,onRemove:g},null,8,["file"]))),128))])):j("",!0)]))}},ge=(e,l)=>F.post(`file-upload?task_id=${l}`,e,{headers:{"Content-Type":"multipart/form-data"}}),Ce=q("fileupload",{state:()=>({files:[],response:[],error:null}),actions:{setFiles(e){this.files=e},async upload(e){if(this.files.length){this.response=[],this.error=null;try{const l=new FormData;this.files.forEach(u=>{l.append("files[]",u)});const s=await ge(l,e);return this.response=s.data||[],console.log(s.data),this.response}catch(l){throw this.error=l.response?.data||l.message||l,console.log(l.response?.data),this.error}}},clear(){this.files=[],this.response=[],this.error=null}}}),ye=e=>F.post("/document_file_create",e),be=e=>F.delete(`/document_file_delete/${e}`),Fe=q("documentfilecreate",{state:()=>({response:null,error:null,loading:!1}),actions:{async createFiles(e,l){if(!(!e||!l?.length)){this.loading=!0,this.error=null;try{const s={incoming_documents_id:e,files:l.map(a=>({url:a.url,type:a.type||"main"}))},u=await ye(s);return this.response=u.data,u.data}catch(s){throw this.error=s.response?.data||s.message,this.error}finally{this.loading=!1}}},async deleteFile(e){if(e){this.loading=!0,this.error=null;try{return(await be(e)).data}catch(l){throw this.error=l.response?.data||l.message,l}finally{this.loading=!1}}},clear(){this.response=null,this.error=null,this.loading=!1}}});export{G as T,je as _,Fe as a,Z as b,Se as c,ie as d,Ce as u};
